GenerationFilters.Include	Resource	ShortTitle	Category	Possible Mitigation	References
target is Azure API Management	Azure API Management	There may be difficulties resolving issues relating to Azure API Management API services due to a lack of resource logs	Denial of Service	"<p>Ensure that your Azure API Management API services are configured to use resource logs in order to collect valuable information on API Management operations and errors. By enabling resource logs through a diagnostic setting, you can gather extensive information on the API requests received and handled by the Azure API Management service gateway.</p>

<p>Enabling resource logs (Azure Monitor logs) for Azure API Management services provides a wealth of insights into API operations and errors, enhancing troubleshooting, auditing, and performance monitoring capabilities. This enables administrators to proactively identify and resolve issues promptly, improve API performance, and gain valuable insights into API usage patterns.</p>"	"<p>Resource logs: <a href=""https://learn.microsoft.com/en-us/azure/api-management/api-management-howto-use-azure-monitor#resource-logs"">https://learn.microsoft.com/en-us/azure/api-management/api-management-howto-use-azure-monitor#resource-logs</a></p>
<p>Diagnostic settings in Azure Monitor: <a href=""https://learn.microsoft.com/en-us/azure/azure-monitor/essentials/diagnostic-settings"">https://learn.microsoft.com/en-us/azure/azure-monitor/essentials/diagnostic-settings</a></p>

<p>Azure CLI Documentation:</p>
<p>az apim list: <a href=""https://learn.microsoft.com/en-us/cli/azure/apim?view=azure-cli-latest#az-apim-list"">https://learn.microsoft.com/en-us/cli/azure/apim?view=azure-cli-latest#az-apim-list</a></p>
<p>az monitor diagnostic-settings list: <a href=""https://learn.microsoft.com/en-us/cli/azure/monitor/diagnostic-settings?view=azure-cli-latest#az-monitor-diagnostic-settings-list"">https://learn.microsoft.com/en-us/cli/azure/monitor/diagnostic-settings?view=azure-cli-latest#az-monitor-diagnostic-settings-list</a></p>
<p>az monitor diagnostic-settings create: <a href=""https://learn.microsoft.com/en-us/cli/azure/monitor/diagnostic-settings?view=azure-cli-latest#az-monitor-diagnostic-settings-create"">https://learn.microsoft.com/en-us/cli/azure/monitor/diagnostic-settings?view=azure-cli-latest#az-monitor-diagnostic-settings-create</a></p> "
target is Azure API Management	Azure API Management	Failure to use response caching may lead to increased bandwidth consumption and processing requirements for Azure API Management APIs	Denial of Service	"<p>Ensure that built-in response caching is enabled for Microsoft Azure API Management APIs in order to reduce latency for API callers and backend load for API providers. To enable response caching, a set of caching policies must be configured at the API level.</p>

<p>Enabling built-in response caching in Azure API Management enhances performance by reducing bandwidth and processing demands on the backend server. This results in lower latency for API consumers, optimizing overall system efficiency and delivering faster responses.</p>

"	"<p>Get from cache: <a href=""https://learn.microsoft.com/en-us/azure/api-management/cache-lookup-policy"">https://learn.microsoft.com/en-us/azure/api-management/cache-lookup-policy</a></p>
<p>Store to cache: <a href=""https://learn.microsoft.com/en-us/azure/api-management/cache-store-policy"">https://learn.microsoft.com/en-us/azure/api-management/cache-store-policy</a></p>

<p>Azure PowerShell Documentation:</p>
<p>az apim list: <a href=""https://learn.microsoft.com/en-us/cli/azure/apim?view=azure-cli-latest#az-apim-list"">https://learn.microsoft.com/en-us/cli/azure/apim?view=azure-cli-latest#az-apim-list</a></p>
<p>az apim api list: <a href=""https://learn.microsoft.com/en-us/cli/azure/apim/api?view=azure-cli-latest#az-apim-api-list"">https://learn.microsoft.com/en-us/cli/azure/apim/api?view=azure-cli-latest#az-apim-api-list</a></p>
<p>New-AzApiManagementContext: <a href=""https://learn.microsoft.com/en-us/powershell/module/az.apimanagement/new-azapimanagementcontext?view=azps-11.0.0"">https://learn.microsoft.com/en-us/powershell/module/az.apimanagement/new-azapimanagementcontext?view=azps-11.0.0</a></p>
<p>Get-AzApiManagementPolicy: <a href=""https://learn.microsoft.com/en-us/powershell/module/az.apimanagement/get-azapimanagementpolicy?view=azps-11.1.0"">https://learn.microsoft.com/en-us/powershell/module/az.apimanagement/get-azapimanagementpolicy?view=azps-11.1.0</a></p>
<p>Set-AzApiManagementPolicy: <a href=""https://learn.microsoft.com/en-us/powershell/module/az.apimanagement/set-azapimanagementpolicy?view=azps-11.1.0"">https://learn.microsoft.com/en-us/powershell/module/az.apimanagement/set-azapimanagementpolicy?view=azps-11.1.0</a></p> "
target is Azure API Management	Azure API Management	Azure API Management API gateways may suffer performance issues if they do not support HTTP/2	Denial of Service	"<p>Ensure that your Azure API Management API gateways are configured to use HTTP/2 in order to increase the API performance on the client-side. HTTP/2 represents a major revision of the HTTP protocol, that has the primary goal of reducing the impact of latency and connection load on servers by implementing full request and response multiplexing, minimizing protocol overhead via compression of HTTP header fields, and by adding support for HTTP request prioritization and server push.</p>

<p>Enabling HTTP/2 for your Azure API Management API gateways can significantly enhance the performance, efficiency, and scalability of your API infrastructure, resulting in a more responsive and efficient API ecosystem.</p>"	"<p>Azure security baseline for API Management: <a href=""https://learn.microsoft.com/en-us/security/benchmark/azure/baselines/api-management-security-baseline"">https://learn.microsoft.com/en-us/security/benchmark/azure/baselines/api-management-security-baseline</a></p>
<p>Manage protocols and ciphers in Azure API Management: <a href=""https://learn.microsoft.com/en-us/azure/api-management/api-management-howto-manage-protocols-ciphers"">https://learn.microsoft.com/en-us/azure/api-management/api-management-howto-manage-protocols-ciphers</a></p>
<p>Api Management Service - Create Or Update: <a href=""https://learn.microsoft.com/en-us/rest/api/apimanagement/api-management-service/create-or-update"">https://learn.microsoft.com/en-us/rest/api/apimanagement/api-management-service/create-or-update</a></p>

<p>Azure PowerShell Documentation:</p>
<p>az apim list: <a href=""https://learn.microsoft.com/en-us/cli/azure/apim?view=azure-cli-latest#az-apim-list"">https://learn.microsoft.com/en-us/cli/azure/apim?view=azure-cli-latest#az-apim-list</a></p>
<p>az apim show: <a href=""https://learn.microsoft.com/en-us/cli/azure/apim?view=azure-cli-latest#az-apim-show"">https://learn.microsoft.com/en-us/cli/azure/apim?view=azure-cli-latest#az-apim-show</a></p>
<p>az apim update: <a href=""https://learn.microsoft.com/en-us/cli/azure/apim?view=azure-cli-latest#az-apim-update"">https://learn.microsoft.com/en-us/cli/azure/apim?view=azure-cli-latest#az-apim-update</a></p> "
target is Azure API Management	Azure API Management	Failure to implement backup and restore facilities may lead to loss of API Management resources.	Denial of Service	"<p>Leverage the backup and restore capabilities in Azure API Management service. When leveraging backup capabilities, Azure API Management writes backups to customer-owned Azure Storage Account. Backup and restore operations are provided by Azure API Management to perform full system backup and restore.</p>

"	"<p>How to implement disaster recovery using service backup and restore in Azure API Management: <a href=""https://learn.microsoft.com/en-gb/azure/api-management/api-management-howto-disaster-recovery-backup-restore"">https://learn.microsoft.com/en-gb/azure/api-management/api-management-howto-disaster-recovery-backup-restore</a></p> "
source is Azure Data Factory	Azure Data Factory	Failure to implement CI/CD and versioning may lead to loss of data	Denial of Service	"<p>By default, the Azure Data Factory UI authors directly against the data factory service which is not optimised for collaboration and version control and does not permit compliance with Sainsbury's tech standards as code cannot be scanned for quality and security.</p>

<p>This can be resolved by implementing Azure Data Factory source control to integrate with Github.</p>

"	"<p>Source control in Azure Data Factory: <a href=""https://learn.microsoft.com/en-gb/azure/data-factory/source-control"">https://learn.microsoft.com/en-gb/azure/data-factory/source-control</a></p>"
source is Azure Data Lake Storage	Azure Data Lake Storage	Data within Azure Data Lake Storage may be lost if no provision is made for retrieving deleted objects or disaster recovery.	Denial of Service	"<p>Soft delete should be configured for Blob storage to ensure information can be recovered from an earlier state.</p>

<p>Data can be regularly copied to another ADLS Gen2 account in a different region for disaster recovery purposes.</p>

"	"<p>Enable blob soft delete (hierarchical namespace): <a href=""https://learn.microsoft.com/en-gb/azure/storage/blobs/soft-delete-blob-enable?tabs=azure-portal#enable-blob-soft-delete-hierarchical-namespace"">https://learn.microsoft.com/en-gb/azure/storage/blobs/soft-delete-blob-enable?tabs=azure-portal#enable-blob-soft-delete-hierarchical-namespace</a></p>
<p>Copy blobs between Azure Storage Account by using AzCopy: <a href=""https://learn.microsoft.com/en-us/azure/storage/common/storage-use-azcopy-blobs-copy"">https://learn.microsoft.com/en-us/azure/storage/common/storage-use-azcopy-blobs-copy</a></p> 
"
target is Azure Key Vault	Azure Key Vault	An adversary may attempt to delete key vault or key vault object causing business disruption.  	Denial of Service	"<p>Ensure that production Azure Key Vaults are recoverable in order to prevent permanent deletion/purging of encryption keys, secrets and certificates stored within these vaults. To make your Azure Key Vault instances recoverable, you need to enable both ""Soft Delete"" and ""Do Not Purge"" features:</p>

<p>""Soft Delete"" implemented by enableSoftDelete parameter, ensures that even if the Key Vault is deleted, the vault itself or its objects (keys, secrets, certificates) remain recoverable for next 90 days. In this span of 90 days, either the vault and its objects can be recovered or purged (permanent deletion). If no action is taken, after 90 days, the Azure Key Vault and all its objects will be purged.</p>

<p>""Do Not Purge"" feature, implemented by enablePurgeProtection parameter, ensures that the Azure Key Vault and its objects cannot be purged at all, preventing users from accidentally purging Azure Key Vault resources. This adds to the ""Soft Delete"" feature which only ensures that Key Vault is not deleted permanently and will be recoverable for 90 days from the date of deletion.</p>

<p>Accidental or malicious deletion or purging of a Key Vault instance can lead to immediate data loss, as the keys encrypting the data and the secrets or certificates allowing access to resources and applications will become non-accessible. To prevent loss of encrypted data including storage accounts, SQL databases, and other cloud resources and services dependent on Key Vault objects (i.e. encryption keys, secrets, certificates) it is recommended to implement Azure Key Vault recoverability by enabling both ""Soft Delete"" and ""Do Not Purge"" features for the production vaults.</p>

<p>Ensure that a Microsoft Azure activity log alert is fired whenever a ""Delete Key Vault"" event is triggered inside your Azure cloud account. An activity log alert fires each time the action event that matches the condition specified in the alert configuration is triggered. An example alert condition could be: ""Whenever the Activity Log has an event with Category='Administrative', Signal name='Delete Key Vault (vaults)'"".</p>

<p>Using Microsoft Azure Monitor service to detect ""Delete Key Vault"" events will help you reduce the time required to mitigate any accidental or intentional deletion of Key Vaults available within your Azure cloud account and improve the Key Vault resources security and management.</p>

"	"<p>Create, view, and manage activity log alerts by using Azure Monitor: <a href=""https://docs.microsoft.com/en-us/azure/azure-monitor/platform/alerts-activity-log"">https://docs.microsoft.com/en-us/azure/azure-monitor/platform/alerts-activity-log</a></p>
<p>Create, view, and manage log alerts using Azure Monitor: <a href=""https://docs.microsoft.com/en-us/azure/azure-monitor/platform/alerts-log"">https://docs.microsoft.com/en-us/azure/azure-monitor/platform/alerts-log</a></p>
<p>Action rules: <a href=""https://docs.microsoft.com/en-us/azure/azure-monitor/platform/alerts-action-rules"">https://docs.microsoft.com/en-us/azure/azure-monitor/platform/alerts-action-rules</a></p>
<p>Get started with Key Vault certificates: <a href=""https://docs.microsoft.com/en-us/azure/key-vault/general/about-keys-secrets-certificates"">https://docs.microsoft.com/en-us/azure/key-vault/general/about-keys-secrets-certificates</a></p>
<p>Azure Key Vault backup and restore: <a href=""https://learn.microsoft.com/en-gb/azure-key-vault/general/backup"">https://learn.microsoft.com/en-gb/azure-key-vault/general/backup</a></p>

<p>Azure CLI Documentation</p>
<p>az monitor activity-log alert list: <a href=""https://docs.microsoft.com/en-us/cli/azure/monitor/activity-log/alert?view=azure-cli-latest#az-monitor-activity-log-alert-list"">https://docs.microsoft.com/en-us/cli/azure/monitor/activity-log/alert?view=azure-cli-latest#az-monitor-activity-log-alert-list</a></p>
<p>az monitor activity-log alert show: <a href=""https://docs.microsoft.com/en-us/cli/azure/monitor/activity-log/alert?view=azure-cli-latest#az-monitor-activity-log-alert-list"">https://docs.microsoft.com/en-us/cli/azure/monitor/activity-log/alert?view=azure-cli-latest#az-monitor-activity-log-alert-list</a></p>
<p>az monitor activity-log alert create: <a href=""https://docs.microsoft.com/en-us/cli/azure/monitor/activity-log/alert?view=azure-cli-latest#az-monitor-activity-log-alert-list"">https://docs.microsoft.com/en-us/cli/azure/monitor/activity-log/alert?view=azure-cli-latest#az-monitor-activity-log-alert-list</a></p> "
target is Azure API Management	Azure API Management	An adversary can abuse poorly managed Azure API Management credentials to gain access to systems	Elevation of Privilege	"<p>Ensure that your Azure API Management service instances are using system-assigned managed identities in order to allow secure access to other Microsoft Azure protected resources such as Azure Key Vaults. System-assigned managed identities minimizes risks, simplifies management, and maintains compliance with evolving cloud services.</p>

<p>Using system-assigned managed identities for Azure API Management services enhances security by allowing the API service instances to authenticate and authorize with Azure resources without the need for explicit credentials, reducing the risk associated with credential management and providing a seamless and more secure integration with other cloud services.</p>

"	"<p>What are managed identities for Azure resources?: <a href=""https://learn.microsoft.com/en-us/azure/active-directory/managed-identities-azure-resources/overview"">https://learn.microsoft.com/en-us/azure/active-directory/managed-identities-azure-resources/overview</a></p>
<p>Use managed identities in Azure API Management: <a href=""https://learn.microsoft.com/en-us/azure/api-management/api-management-howto-use-managed-service-identity"">https://learn.microsoft.com/en-us/azure/api-management/api-management-howto-use-managed-service-identity</a></p>
<p>Authenticate with managed identity: <a href=""https://learn.microsoft.com/en-us/azure/api-management/authentication-managed-identity-policy"">https://learn.microsoft.com/en-us/azure/api-management/authentication-managed-identity-policy</a></p>

<p>Azure PowerShell Documentation:</p>
<p>az apim list: <a href=""https://learn.microsoft.com/en-us/cli/azure/apim?view=azure-cli-latest#az-apim-list"">https://learn.microsoft.com/en-us/cli/azure/apim?view=azure-cli-latest#az-apim-list</a></p>
<p>az apim show: <a href=""https://learn.microsoft.com/en-us/cli/azure/apim?view=azure-cli-latest#az-apim-show"">https://learn.microsoft.com/en-us/cli/azure/apim?view=azure-cli-latest#az-apim-show</a></p>
<p>Get-AzApiManagement: <a href=""https://learn.microsoft.com/en-us/powershell/module/az.apimanagement/get-azapimanagement?view=azps-11.0.0"">https://learn.microsoft.com/en-us/powershell/module/az.apimanagement/get-azapimanagement?view=azps-11.0.0</a></p>
<p>Set-AzApiManagement: <a href=""https://learn.microsoft.com/en-us/powershell/module/az.apimanagement/set-azapimanagement?view=azps-11.0.0"">https://learn.microsoft.com/en-us/powershell/module/az.apimanagement/set-azapimanagement?view=azps-11.0.0</a></p> "
target is Azure API Management	Azure API Management	Failure to use user-assigned managed identities for Azure API Management service instances could lead to roles having excessive permissions	Elevation of Privilege	"<p>Ensure that your Azure API Management service instances are using user-assigned managed identities for fine-grained control over access permissions.</p>

<p>In Azure cloud, user-assigned identities encompass a broader range of roles beyond ""Read-Only"", ""Contributor"", and ""Owner"" support. Therefore, Azure API Management services should use user-assigned managed identities to provide granular control over access permissions, enable integration with existing identity systems, and support specific application requirements. User-assigned managed identities offer flexibility in managing identities and access control for Azure API Management service instances, allowing for fine-grained customization based on individual needs.</p>

"	"<p>What are managed identities for Azure resources?: <a href=""https://learn.microsoft.com/en-us/azure/active-directory/managed-identities-azure-resources/overview"">https://learn.microsoft.com/en-us/azure/active-directory/managed-identities-azure-resources/overview</a></p>
<p>Use managed identities in Azure API Management: <a href=""https://learn.microsoft.com/en-us/azure/api-management/api-management-howto-use-managed-service-identity"">https://learn.microsoft.com/en-us/azure/api-management/api-management-howto-use-managed-service-identity</a></p>
<p>Authenticate with managed identity: <a href=""https://learn.microsoft.com/en-us/azure/api-management/authentication-managed-identity-policy"">https://learn.microsoft.com/en-us/azure/api-management/authentication-managed-identity-policy</a></p>

<p>Azure CLI and PowerShell Documentation:</p>
<p>az apim list: <a href=""https://learn.microsoft.com/en-us/cli/azure/apim?view=azure-cli-latest#az-apim-list"">https://learn.microsoft.com/en-us/cli/azure/apim?view=azure-cli-latest#az-apim-list</a></p>
<p>az apim show: <a href=""https://learn.microsoft.com/en-us/cli/azure/apim?view=azure-cli-latest#az-apim-show"">https://learn.microsoft.com/en-us/cli/azure/apim?view=azure-cli-latest#az-apim-show</a></p>
<p>Get-AzApiManagement: <a href=""https://learn.microsoft.com/en-us/powershell/module/az.apimanagement/get-azapimanagement?view=azps-11.0.0"">https://learn.microsoft.com/en-us/powershell/module/az.apimanagement/get-azapimanagement?view=azps-11.0.0</a></p>
<p>New-AzUserAssignedIdentity: <a href=""https://learn.microsoft.com/en-us/powershell/module/az.managedserviceidentity/new-azuserassignedidentity?view=azps-11.0.0"">https://learn.microsoft.com/en-us/powershell/module/az.managedserviceidentity/new-azuserassignedidentity?view=azps-11.0.0</a></p>
<p>Set-AzApiManagement: <a href=""https://learn.microsoft.com/en-us/powershell/module/az.apimanagement/set-azapimanagement?view=azps-11.0.0"">https://learn.microsoft.com/en-us/powershell/module/az.apimanagement/set-azapimanagement?view=azps-11.0.0</a></p> "
source is Azure API Management	Azure API Management	A user may be able to perform functions beyond their role requirements due to failure to implement the principle of least privilege.	Elevation of Privilege	"<p>Use Azure role-based access control (Azure RBAC) for controlling access to Azure API Management.  Built-in roles are provided to cover standard use cases but it is also possible to create custom roles, for example to provide write access to a specific API.</p>"	"<p>How to use role-based access control in Azure API Management <a href=""https://learn.microsoft.com/en-gb/azure/api-management/api-management-role-based-access-control"">https://learn.microsoft.com/en-gb/azure/api-management/api-management-role-based-access-control</a></p> "
source is Azure API Management	Azure API Management	An attacker may be able to abuse local administrator accounts in Azure API Management	Elevation of Privilege	"<p>Any local administrative accounts for Azure API Management should be disabled or restricted for emergency use only.  Local authentication should be disabled and users authenticated using Azure AD, assigning appropriate RBAC permissions to these users.</p>"	"<p>How to manage user accounts in Azure API Management: <a href=""https://learn.microsoft.com/en-gb/azure/api-management/api-management-howto-create-or-invite-developers"">https://learn.microsoft.com/en-gb/azure/api-management/api-management-howto-create-or-invite-developers</a></p>"
source is Azure Data Factory	Azure Data Factory	A user may be able to perform actions beyond their role requirements due to failure to apply the principle of least privilege	Elevation of Privilege	"<p>Use Azure's built-in Azure Data Factory roles to assign users the permissions required for their roles.</p>

<p>You can create more restrictive custom roles in Azure AD but these should only be created when required.</p>

"	"<p>Roles and permissions for Azure Data Factory: <a href=""https://learn.microsoft.com/en-us/azure/data-factory/concepts-roles-permissions"">https://learn.microsoft.com/en-us/azure/data-factory/concepts-roles-permissions</a></p> "
target is Azure Data Lake Storage	Azure Data Lake Storage	An adversary may gain unauthorised access to Azure Data Lake Storage in a subscription.	Elevation of Privilege	"<p>Assign the appropriate Role-Based Access Control (RBAC) role to users, groups and applications at the right scope for the Azure Storage instance.  Use ACLs to enforce fine-grained access controls to directories and files.</p>
"	"<p>Access control model in Azure Data Lake Storage: <a href=""https://learn.microsoft.com/en-us/azure/storage/blobs/data-lake-storage-access-control-model"">https://learn.microsoft.com/en-us/azure/storage/blobs/data-lake-storage-access-control-model</a></p>
<p>Access control lists (ACLs) in Azure Data Lake Storage: <a href=""https://learn.microsoft.com/en-us/azure/storage/blobs/data-lake-storage-access-control"">https://learn.microsoft.com/en-us/azure/storage/blobs/data-lake-storage-access-control</a></p> "
target is Azure Data Lake Storage	Azure Data Lake Storage	An adversary can gain unauthorised access to {target.Name} due to weak CORS configuration.	Elevation of Privilege	"<p>Ensure that only specific, trusted origins are allowed.</p>
"	"<p>Cross-Origin Resource Sharing (CORS) support for Azure Storage: <a href=""https://learn.microsoft.com/en-us/rest/api/storageservices/cross-origin-resource-sharing--cors--support-for-the-azure-storage-services"">https://learn.microsoft.com/en-us/rest/api/storageservices/cross-origin-resource-sharing--cors--support-for-the-azure-storage-services</a></p>
<p>Security recommendations for Blob storage: <a href=""https://aka.ms/tmt-th21"">https://aka.ms/tmt-th21</a></p> "
target is Azure Data Lake Storage	Azure Data Lake Storage	An adversary can abuse poorly managed Azure Data Lake Storage account access keys and gain unauthorised access to storage.	Elevation of Privilege	"<p>Use Entra ID with managed identities to authorise requests against storage where possible.  For resources hosted outside of Azure, such as on-premises applications, you can use managed identities through Azure Arc.</p>
<p>Ensure secure management and storage of Azure storage access keys. It is recommended to rotate storage access keys regularly, in accordance with organizational policies.</p>
<p>Shared key authorisation should be disallowed for the storage account where possible.  The Storage Blob Data Owner role can be used to manage ADLS ACLs when shared key authorisation is disabled.</p>
"	"<p>Prevent Shared Key authorization for an Azure Storage account: <a href=""https://learn.microsoft.com/en-us/azure/storage/common/shared-key-authorization-prevent"">https://learn.microsoft.com/en-us/azure/storage/common/shared-key-authorization-prevent</a></p>
<p>Security recommendations for Blob storage: <a href=""https://aka.ms/tmt-th63"">https://aka.ms/tmt-th63</a></p>
<p>Storage Blob Data Owner role: <a href=""https://learn.microsoft.com/en-us/azure/storage/common/shared-key-authorization-prevent"">https://learn.microsoft.com/en-us/azure/storage/common/shared-key-authorization-prevent</a></p>"
target is Azure Data Lake Storage	Azure Data Lake Storage	An adversary can gain access to data within Azure Data Lake Storage due to weak access control restrictions	Elevation of Privilege	"<p>Grant limited access to objects in Azure Storage using Shared Access Signatures (SAS) with a Stored Access Policy (SAP). It is recommended to scope SAS and SAP to permit only the necessary permissions over a short period of time.</p>
<p>A service SAS that is not associate with a stored access policy cannot be revoked.  For this reason, it is recommended to limit the expiry time so that the SAS is valid for one hour or less.</p>
"	"<p>Grant limited access to Azure Storage resources using shared access signatures (SAS): <a href=""https://aka.ms/tmt-th17a"">https://aka.ms/tmt-th17a</a></p>
<p>Define a stored access policy: <a href=""https://learn.microsoft.com/en-us/rest/api/storageservices/define-stored-access-policy"">https://learn.microsoft.com/en-us/rest/api/storageservices/define-stored-access-policy</a></p> "
target is Azure Data Lake Storage	Azure Data Lake Storage	An adversary can gain unauthorised access to Azure Data Lake Storage due to weak network configuration.	Elevation of Privilege	"<p>It is recommended to restrict access to Azure Storage instances to selected networks where possible.</p>

"	"<p>Configure Azure Storage firewalls and virtual networks: <a href=""https://aka.ms/tmt-th140"">https://aka.ms/tmt-th140</a></p>
<p>Connect privately to a storage account using Azure Private Endpoint: <a href=""https://learn.microsoft.com/en-us/azure/private-link/tutorial-private-endpoint-storage-portal"">https://learn.microsoft.com/en-us/azure/private-link/tutorial-private-endpoint-storage-portal</a></p> "
target is Azure Key Vault	Azure Key Vault	"An adversary can gain long term, persistent access to systems due to failure to expire Azure Key Vault keys"	Elevation of Privilege	"<p>Ensure that all the encryption keys available within your Microsoft Azure Key Vault have an expiration time set in order to follow security best practices and promote encryption key rotation. The expiration attribute configured for an encryption key identifies the expiration date and time after which the key must not be used anymore for a cryptographic operations.</p>

<p>Microsoft Azure Key Vault enables you to store and use encryption keys within your Azure cloud environment. By default, the encryption keys stored within a vault never expire. Therefore, it is recommended that you configure all your keys with an explicit expiration time, so that these keys can't be used beyond their assigned lifetime. This should significantly reduce the chance that a compromised key could be used without your knowledge to access valuable Azure cloud resources.</p>

"	"<p>Azure Key Vault basic concepts: <a href=""https://docs.microsoft.com/en-us/azure/key-vault/basic-concepts"">https://docs.microsoft.com/en-us/azure/key-vault/basic-concepts</a></p>
<p>CIS Microsoft Azure Foundations: <a href=""https://azure.microsoft.com/mediahandler/files/resourcefiles/cis-microsoft-azure-foundations-security-benchmark/CIS_Microsoft_Azure_Foundations_Benchmark_v1.0.0.pdf"">https://azure.microsoft.com/mediahandler/files/resourcefiles/cis-microsoft-azure-foundations-security-benchmark/CIS_Microsoft_Azure_Foundations_Benchmark_v1.0.0.pdf</a></p>

<p>Azure CLI Documentation:</p>
<p>az keyvault key: <a href=""https://docs.microsoft.com/en-us/cli/azure/keyvault/key?view=azure-cli-latest"">https://docs.microsoft.com/en-us/cli/azure/keyvault/key?view=azure-cli-latest</a></p>
<p>az keyvault list: <a href=""https://docs.microsoft.com/en-us/cli/azure/keyvault?view=azure-cli-latest#az-keyvault-list"">https://docs.microsoft.com/en-us/cli/azure/keyvault?view=azure-cli-latest#az-keyvault-list</a></p>
<p>az keyvault key list: <a href=""https://docs.microsoft.com/en-us/cli/azure/keyvault/key?view=azure-cli-latest#az-keyvault-key-list"">https://docs.microsoft.com/en-us/cli/azure/keyvault/key?view=azure-cli-latest#az-keyvault-key-list</a></p>
<p>az keyvault key show: <a href=""https://docs.microsoft.com/en-us/cli/azure/keyvault/key?view=azure-cli-latest#az-keyvault-key-show"">https://docs.microsoft.com/en-us/cli/azure/keyvault/key?view=azure-cli-latest#az-keyvault-key-show</a></p>
<p>az keyvault key set-attributes: <a href=""https://docs.microsoft.com/en-us/cli/azure/keyvault/key?view=azure-cli-latest#az-keyvault-key-set-attributes"">https://docs.microsoft.com/en-us/cli/azure/keyvault/key?view=azure-cli-latest#az-keyvault-key-set-attributes</a></p> "
target is Azure Key Vault	Azure Key Vault	An adversary may gain unauthorized access to manage {target.Name} due to weak authorization rules.	Elevation of Privilege	"<p>Access to the Azure Key Vault management plane should be restricted by choosing appropriate Role-Based Access Control (RBAC) roles and privileges in accordance with the principle of least privilege. Over permissive or weak authorization rules may potentially permit data plane access (e.g. a user with Contribute (RBAC) permissions to Key Vault management plane may grant themselves access to the data plane by setting the Azure Key Vault access policy).</p>
"	"<p>Azure Key Vault security: <a href=""https://aka.ms/tmt-th181"">https://aka.ms/tmt-th181</a></p>
<p>Azure Key Vault RBAC support: <a href=""https://docs.microsoft.com/azure/key-vault/general/rbac-guide?tabs=azure-cli"">https://docs.microsoft.com/azure/key-vault/general/rbac-guide?tabs=azure-cli</a></p> "
target is Azure Key Vault	Azure Key Vault	An adversary may gain unauthorized access to {target.Name} secrets due to weak authorization rules	Elevation of Privilege	"<p>Limit Azure Key Vault data plane access by configuring strict access policies. Grant users, groups and applications the ability to perform only the necessary operations against keys or secrets in a Key Vault instance.</p>

<p>Ensure that your Microsoft Azure key vaults are configured to allow access only to trusted Azure subscription in order to protect against unauthorized access. This approach strengthens security by minimizing the risk of unauthorized access to sensitive data stored in Azure key vaults.</p>

<p>It is crucial to avoid cross-subscription access to Azure Key Vault in order to maintain robust security boundaries and prevent unauthorized access to sensitive cryptographic materials. Allowing key vault resources to be accessed from different subscriptions can increase the risk of data breaches by broadening the attack surface and potentially exposing cryptographic assets to unauthorized users or services in other subscriptions.</p>

<p>Follow the principle of least privilege and grant privileges only as needed.</p>

"	"<p>Azure Key Vault security: <a href=""https://docs.microsoft.com/en-us/azure/key-vault/overview-security and https://learn.microsoft.com/en-gb/azure/key-vault/general/security-features"">https://docs.microsoft.com/en-us/azure/key-vault/overview-security and https://learn.microsoft.com/en-gb/azure/key-vault/general/security-features</a></p>

<p>Azure role-based access control (Azure RBAC) vs. access policies (legacy): <a href=""https://learn.microsoft.com/en-us/azure/key-vault/general/rbac-access-policy"">https://learn.microsoft.com/en-us/azure/key-vault/general/rbac-access-policy</a></p>

<p>Provide access to Key Vault keys, certificates and secrets with an Azure role-based access control: <a href=""https://learn.microsoft.com/en-us/azure/key-vault/general/rbac-guide?tabs=azure-cli"">https://learn.microsoft.com/en-us/azure/key-vault/general/rbac-guide?tabs=azure-cli</a></p>

<p>Azure Key Vault authentication: <a href=""https://docs.microsoft.com/azure/key-vault/general/authentication"">https://docs.microsoft.com/azure/key-vault/general/authentication</a></p>

<p>Azure CLI Documentation:</p>
<p>az account list: <a href=""https://docs.microsoft.com/en-us/cli/azure/account?view=azure-cli-latest#az-account-list"">https://docs.microsoft.com/en-us/cli/azure/account?view=azure-cli-latest#az-account-list</a></p>
<p>az keyvault list: <a href=""https://docs.microsoft.com/en-us/cli/azure/keyvault?view=azure-cli-latest#az-keyvault-list"">https://docs.microsoft.com/en-us/cli/azure/keyvault?view=azure-cli-latest#az-keyvault-list</a></p>
<p>az role assignment list: <a href=""https://learn.microsoft.com/en-us/cli/azure/role/assignment?view=azure-cli-latest#az-role-assignment-list"">https://learn.microsoft.com/en-us/cli/azure/role/assignment?view=azure-cli-latest#az-role-assignment-list</a></p>
<p>az role assignment delete: <a href=""https://learn.microsoft.com/en-us/cli/azure/role/assignment?view=azure-cli-latest#az-role-assignment-delete"">https://learn.microsoft.com/en-us/cli/azure/role/assignment?view=azure-cli-latest#az-role-assignment-delete</a></p> "
target is Azure Key Vault	Azure Key Vault	A user may be able to gain access to privileged credentials due to overly permissive Azure Key Vault settings	Elevation of Privilege	"<p>Ensure that there is no Microsoft Azure user, group or application with full administrator privileges configured to access and manage Azure Key Vaults, in order to adhere to security best practices and implement the principle of least privilege (i.e. the practice of providing every principal the minimal amount of access required to perform its tasks).</p>

<p>Because Azure Key Vaults are storing sensitive and business critical data, you need to take actions to maximize the security of your vaults and the data stored in them. An important measure is to grant a principal (user, group or application) access to execute only specific operations for Azure Key Vault keys, secrets or certificates. This can be extremely useful when, for example, an Azure user with administrator-level permissions (full privileges) is used by an inexperienced person to access your Key Vault data, as his actions can lead to severe security issues, data leaks and data loss.</p>

<p>Note: Azure Key Vault access policies apply at the vault level. When a principal is granted permission to create, update and delete keys, he can perform these operations on all the keys available in that vault.</p>

"	"<p>Azure Key Vault security: <a href=""https://docs.microsoft.com/en-us/azure/key-vault/general/overview-security"">https://docs.microsoft.com/en-us/azure/key-vault/general/overview-security</a></p>
<p>Secure access to a key vault: <a href=""https://docs.microsoft.com/en-us/azure/key-vault/general/overview-security"">https://docs.microsoft.com/en-us/azure/key-vault/general/overview-security</a></p>
<p>Provide Key Vault authentication with an access control policy: <a href=""https://docs.microsoft.com/en-us/azure/key-vault/general/group-permissions-for-apps"">https://docs.microsoft.com/en-us/azure/key-vault/general/group-permissions-for-apps</a></p>

<p>Azure CLI Documentation:</p>
<p>az keyvault list: <a href=""https://docs.microsoft.com/en-us/cli/azure/keyvault?view=azure-cli-latest#az-keyvault-list"">https://docs.microsoft.com/en-us/cli/azure/keyvault?view=azure-cli-latest#az-keyvault-list</a></p>
<p>az keyvault show: <a href=""https://docs.microsoft.com/en-us/cli/azure/keyvault?view=azure-cli-latest#az-keyvault-show"">https://docs.microsoft.com/en-us/cli/azure/keyvault?view=azure-cli-latest#az-keyvault-show</a></p>
<p>az keyvault delete-policy: <a href=""https://docs.microsoft.com/en-us/cli/azure/keyvault?view=azure-cli-latest#az-keyvault-delete-policy"">https://docs.microsoft.com/en-us/cli/azure/keyvault?view=azure-cli-latest#az-keyvault-delete-policy</a></p> "
target is Azure Key Vault and not target.Key Vault Network Access Controls is 'Allow access from selected networks'	Azure Key Vault	An adversary can gain unauthorized access to Azure Key Vault instances due to weak network security configuration.	Elevation of Privilege	<p>Restrict access to Azure Key Vault instances by configuring firewall rules to permit connections from selected networks (e.g. a virtual network or a custom set of IP addresses).</p>	"<p>Access Azure Key Vault behind a firewall: <a href=""https://aka.ms/tmt-th179"">https://aka.ms/tmt-th179</a></p>"
target is Azure API Management	Azure API Management	Credentials and secrets may be exposed due to failure to manage them securely	Information Disclosure	"<p>While it is possible to store secrets within Azure API Management using named values and storing sensitive information in an encrypted format, this is not the preferred approach.</p>

<p>Using key vault secrets is recommended as granular access policies can be applied to secrets.  However, API Management cannot retrieve secrets from Azure Key Vault that exceed 4096 characters.</p>

"	"<p>Prerequisites for key vault integration: <a href=""https://docs.microsoft.com/azure/api-management/api-management-howto-properties?tabs=azure-portal#prerequisites-for-key-vault-integration"">https://docs.microsoft.com/azure/api-management/api-management-howto-properties?tabs=azure-portal#prerequisites-for-key-vault-integration</a></p>
<p>Use named values in Azure API Management policies: <a href=""https://learn.microsoft.com/en-us/azure/api-management/api-management-howto-properties?tabs=azure-portal"">https://learn.microsoft.com/en-us/azure/api-management/api-management-howto-properties?tabs=azure-portal</a></p>
<p>How to set or edit Azure API Management policies: <a href=""https://learn.microsoft.com/en-us/azure/api-management/set-edit-policies?tabs=form"">https://learn.microsoft.com/en-us/azure/api-management/set-edit-policies?tabs=form</a></p>

<p>Azure PowerShell Documentation:</p>
<p>az apim list: <a href=""https://learn.microsoft.com/en-us/cli/azure/apim?view=azure-cli-latest#az-apim-list"">https://learn.microsoft.com/en-us/cli/azure/apim?view=azure-cli-latest#az-apim-list</a></p>
<p>az apim nv list: <a href=""https://learn.microsoft.com/en-us/cli/azure/apim/nv?view=azure-cli-latest#az-apim-nv-list"">https://learn.microsoft.com/en-us/cli/azure/apim/nv?view=azure-cli-latest#az-apim-nv-list</a></p>
<p>az apim nv show: <a href=""https://learn.microsoft.com/en-us/cli/azure/apim/nv?view=azure-cli-latest#az-apim-nv-show"">https://learn.microsoft.com/en-us/cli/azure/apim/nv?view=azure-cli-latest#az-apim-nv-show</a></p>
<p>az apim nv create: <a href=""https://learn.microsoft.com/en-us/cli/azure/apim/nv?view=azure-cli-latest#az-apim-nv-create"">https://learn.microsoft.com/en-us/cli/azure/apim/nv?view=azure-cli-latest#az-apim-nv-create</a></p>
<p>New-AzKeyVault: <a href=""https://learn.microsoft.com/en-us/powershell/module/az.keyvault/new-azkeyvault?view=azps-11.1.0"">https://learn.microsoft.com/en-us/powershell/module/az.keyvault/new-azkeyvault?view=azps-11.1.0</a></p>
<p>Set-AzKeyVaultAccessPolicy: <a href=""https://learn.microsoft.com/en-us/powershell/module/az.keyvault/set-azkeyvaultaccesspolicy?view=azps-11.1.0"">https://learn.microsoft.com/en-us/powershell/module/az.keyvault/set-azkeyvaultaccesspolicy?view=azps-11.1.0</a></p>
<p>Set-AzKeyVaultSecret: <a href=""https://learn.microsoft.com/en-us/powershell/module/az.keyvault/set-azkeyvaultsecret?view=azps-11.1.0"">https://learn.microsoft.com/en-us/powershell/module/az.keyvault/set-azkeyvaultsecret?view=azps-11.1.0</a></p>
<p>New-AzApiManagementContext: <a href=""https://learn.microsoft.com/en-us/powershell/module/az.apimanagement/new-azapimanagementcontext?view=azps-11.1.0"">https://learn.microsoft.com/en-us/powershell/module/az.apimanagement/new-azapimanagementcontext?view=azps-11.1.0</a></p>
<p>New-AzApiManagementKeyVaultObject: <a href=""https://learn.microsoft.com/en-us/powershell/module/az.apimanagement/new-azapimanagementkeyvaultobject?view=azps-11.1.0"">https://learn.microsoft.com/en-us/powershell/module/az.apimanagement/new-azapimanagementkeyvaultobject?view=azps-11.1.0</a></p>
<p>New-AzApiManagementNamedValue: <a href=""https://learn.microsoft.com/en-us/powershell/module/az.apimanagement/new-azapimanagementnamedvalue?view=azps-11.1.0"">https://learn.microsoft.com/en-us/powershell/module/az.apimanagement/new-azapimanagementnamedvalue?view=azps-11.1.0</a></p> "
target is Azure API Management	Azure API Management	Information may be disclosed due to weak authentication between apps and the API management backend.	Information Disclosure	"<p>Mutual TLS should be used to provide strong authentication to the API Management backend.</p>

<p>Set up integration of API Management with Azure Key Vault. Ensure that secrets for API Management (Named values) are stored an Azure Key Vault so they can be securely accessed and updated.</p>

<p>Use Azure Key Vault to create and control the certificate lifecycle, including creation, importing, rotation, revocation, storage, and purging of the certificate. Ensure the certificate generation follows standards defined in the Cryptography Security Policy without using any insecure properties, such as: insufficient key size, overly long validity period, insecure cryptography. Setup automatic rotation of the certificate in Azure Key Vault and the Azure service (if supported) based on a defined schedule or when there is a certificate expiration. If automatic rotation is not supported in the application, ensure they are still rotated using manual methods in Azure Key Vault and the application.</p>

"	"<p>Secure backend services using client certificate authentication in Azure API Management: <a href=""https://docs.microsoft.com/azure/api-management/api-management-howto-mututal-certificates"">https://docs.microsoft.com/azure/api-management/api-management-howto-mututal-certificates</a></p> "
target is Azure API Management	Azure API Management	Publicly accessible Azure API Management services may be subject to unauthorised access attempts and other attacks	Information Disclosure	"<p>Azure API Management services configured with a private endpoint should not be publicly accessible in order to enhance security by ensuring that the API service instance is only accessible from within your private network, over Azure Private Link, limiting exposure to potential external threats and unauthorized access.</p>

<p>When an Azure API Management service instance configured with a private endpoint is publicly accessible, it opens up the backend services to the public Internet, increasing the risk of unauthorized access, potential security breaches, and compliance violations. Therefore, it is vital to restrict access to these instances solely within the private network to maintain the security and integrity of the backend infrastructure.</p>

"	"<p>Use a virtual network to secure inbound and outbound traffic for Azure API Management: <a href=""https://learn.microsoft.com/en-us/azure/api-management/virtual-network-concepts"">https://learn.microsoft.com/en-us/azure/api-management/virtual-network-concepts</a></p>
<p>Deploy your Azure API Management instance to a virtual network - internal mode: <a href=""https://learn.microsoft.com/en-us/azure/api-management/api-management-using-with-internal-vnet"">https://learn.microsoft.com/en-us/azure/api-management/api-management-using-with-internal-vnet</a></p>
<p>Connect privately to API Management using an inbound private endpoint: <a href=""https://learn.microsoft.com/en-us/azure/api-management/private-endpoint"">https://learn.microsoft.com/en-us/azure/api-management/private-endpoint</a></p>
<p>PrivateLinkServiceConnectionState: <a href=""https://learn.microsoft.com/en-us/rest/api/apimanagement/api-management-service/create-or-update#privatelinkserviceconnectionstate"">https://learn.microsoft.com/en-us/rest/api/apimanagement/api-management-service/create-or-update#privatelinkserviceconnectionstate</a></p>
<p>Private Link: <a href=""https://azure.microsoft.com/en-us/products/private-link"">https://azure.microsoft.com/en-us/products/private-link</a></p>

<p>Azure CLI Documentation</p>
<p>az apim list: <a href=""https://learn.microsoft.com/en-us/cli/azure/apim?view=azure-cli-latest#az-apim-list"">https://learn.microsoft.com/en-us/cli/azure/apim?view=azure-cli-latest#az-apim-list</a></p>
<p>az apim show: <a href=""https://learn.microsoft.com/en-us/cli/azure/apim?view=azure-cli-latest#az-apim-show"">https://learn.microsoft.com/en-us/cli/azure/apim?view=azure-cli-latest#az-apim-show</a></p>
<p>az apim update: <a href=""https://learn.microsoft.com/en-us/cli/azure/apim?view=azure-cli-latest#az-apim-update"">https://learn.microsoft.com/en-us/cli/azure/apim?view=azure-cli-latest#az-apim-update</a></p> "
target is Azure API Management	Azure API Management	Sensitive information may be disclosed to unauthorised users if HTTPS is not enforced for Azure API Management APIs	Information Disclosure	"<p>Ensure that your Azure API Management APIs are configured to enforce HTTPS for all API calls in order to provide secure, encrypted communication, protect data integrity, user privacy, and comply with industry standards.</p>

<p>Enforcing HTTPS for all API calls within Azure API Management enhances security and protects sensitive data. It prevents interception, ensures authentication, and maintains compatibility with modern browsers. Following best practices demonstrates your commitment to data security.</p>

"	"<p>Authentication and authorization to APIs in Azure API Management: <a href=""https://learn.microsoft.com/en-us/azure/api-management/authentication-authorization-overview"">https://learn.microsoft.com/en-us/azure/api-management/authentication-authorization-overview</a></p>

<p>Recommendations to mitigate OWASP API Security Top 10 threats using API Management: <a href=""https://learn.microsoft.com/en-us/azure/api-management/mitigate-owasp-api-threats"">https://learn.microsoft.com/en-us/azure/api-management/mitigate-owasp-api-threats</a></p>

<p>Azure PowerShell Documentation:</p>
<p>az apim list: <a href=""https://learn.microsoft.com/en-us/cli/azure/apim?view=azure-cli-latest#az-apim-list"">https://learn.microsoft.com/en-us/cli/azure/apim?view=azure-cli-latest#az-apim-list</a></p>
<p>az apim api list: <a href=""https://learn.microsoft.com/en-us/cli/azure/apim/api?view=azure-cli-latest#az-apim-api-list"">https://learn.microsoft.com/en-us/cli/azure/apim/api?view=azure-cli-latest#az-apim-api-list</a></p>
<p>az apim api show: <a href=""https://learn.microsoft.com/en-us/cli/azure/apim/api?view=azure-cli-latest#az-apim-api-show"">https://learn.microsoft.com/en-us/cli/azure/apim/api?view=azure-cli-latest#az-apim-api-show</a></p>
<p>az apim api update: <a href=""https://learn.microsoft.com/en-us/cli/azure/apim/api?view=azure-cli-latest#az-apim-api-update"">https://learn.microsoft.com/en-us/cli/azure/apim/api?view=azure-cli-latest#az-apim-api-update</a></p> "
target is Azure API Management	Azure API Management	Sensitive information may be disclosed due to API Management API gateways being configured to use weak TLS ciphers	Information Disclosure	"<p>Ensure that your Azure API Management API gateways are not configured to use weak or deprecated TLS ciphers for client and backend communication. The following TLS ciphers are considered weak or deprecated:</p>

<p>TLS_RSA_WITH_AES_128_CBC_SHA<br/>
TLS_RSA_WITH_AES_256_CBC_SHA<br/>
TLS_RSA_WITH_AES_128_CBC_SHA256<br/>
TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA<br/>
TLS_RSA_WITH_AES_256_CBC_SHA256<br/>
TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA<br/>
TLS_RSA_WITH_AES_128_GCM_SHA256<br/>
TLS_RSA_WITH_3DES_EDE_CBC_SHA (TRIPLE DES)</p>

<p>Weak or deprecated ciphers are vulnerable to security attacks and can expose sensitive data to unauthorized personnel. Ensuring that Azure API Management API gateways are not configured to use vulnerable TLS ciphers is crucial for maintaining a secure and compliant API infrastructure.</p>"	"<p>Manage protocols and ciphers in Azure API Management: <a href=""https://learn.microsoft.com/en-gb/azure/api-management/api-management-howto-manage-protocols-ciphers"">https://learn.microsoft.com/en-gb/azure/api-management/api-management-howto-manage-protocols-ciphers</a></p> 
"
target is Azure API Management	Azure API Management	Sensitive information may be disclosed due to Azure API Management API gateways being configured to use deprecated TLS protocols	Information Disclosure	"<p>Ensure that your Azure API Management API gateways are not configured to use weak and deprecated TLS protocols such as TLS 1.0 and TLS 1.1. To follow security best practices and protect your APIs from potential exploits that can target flaws in the older versions of the TLS protocol, ensure that your API gateways are using the the latest supported version of TLS.</p>

<p>The Transport Layer Security (TLS) protocol addresses network security problems such as tampering and eavesdropping between a client and a server. An Azure API Management service supports multiple versions of the TLS protocol to secure API traffic for both client side and backend side. Using weak and deprecated TLS protocols can increase opportunities for malicious activities such as hacking, Man-in-the-Middle (MITM) and downgrade attacks, therefore it is strongly recommended to use only the latest TLS version.</p>


"	"<p>Azure security baseline for API Management: <a href=""https://learn.microsoft.com/en-us/security/benchmark/azure/baselines/api-management-security-baseline"">https://learn.microsoft.com/en-us/security/benchmark/azure/baselines/api-management-security-baseline</a></p>

<p>Manage protocols and ciphers in Azure API Management: <a href=""https://learn.microsoft.com/en-us/azure/api-management/api-management-howto-manage-protocols-ciphers"">https://learn.microsoft.com/en-us/azure/api-management/api-management-howto-manage-protocols-ciphers</a></p>

<p>Azure PowerShell Documentation:</p>

<p>az apim list: <a href=""https://learn.microsoft.com/en-us/cli/azure/apim?view=azure-cli-latest#az-apim-list"">https://learn.microsoft.com/en-us/cli/azure/apim?view=azure-cli-latest#az-apim-list</a></p>
<p>az apim show: <a href=""https://learn.microsoft.com/en-us/cli/azure/apim?view=azure-cli-latest#az-apim-show"">https://learn.microsoft.com/en-us/cli/azure/apim?view=azure-cli-latest#az-apim-show</a></p>
<p>az apim update: <a href=""https://learn.microsoft.com/en-us/cli/azure/apim?view=azure-cli-latest#az-apim-update"">https://learn.microsoft.com/en-us/cli/azure/apim?view=azure-cli-latest#az-apim-update</a></p> "
source is Azure Data Factory	Azure Data Factory	Azure Data Factory may be used to conduct unauthorised data exfiltration due to failure to restrict outbound connections.	Information Disclosure	"<p>Attach an Azure Policy to the resource group containing the Azure Data Factory, specifying the trusted domains.  This policy can then be enforced by enabling outbound rules on the data factory.</p>

"	"<p>Outbound network rules using Azure Policy: <a href=""https://learn.microsoft.com/en-us/azure/data-factory/configure-outbound-allow-list-azure-policy"">https://learn.microsoft.com/en-us/azure/data-factory/configure-outbound-allow-list-azure-policy</a></p> "
source is Azure Data Factory	Azure Data Factory	"Credentials, secrets, or certificates used for Azure Data Factory may be exposed due to insecure management"	Information Disclosure	"<p>Credentials for data stores and computes should be stored in Azure Key Vault and retrieved using a Managed Identity for Data Factory.</p>

<p>Ensure the Secure Output option is used when retrieving the secret within Azure Data Factory to prevent the secret value from being logged in plain text.  Further activities that consume this secret should have their Secure Input option set to true.</p>

"	"<p>Store credentials in Azure Key Vault: <a href=""https://learn.microsoft.com/en-gb/azure/data-factory/store-credentials-in-key-vault"">https://learn.microsoft.com/en-gb/azure/data-factory/store-credentials-in-key-vault</a></p>
<p>Use Azure Key Vault secrets in pipeline activities: <a href=""https://learn.microsoft.com/en-us/azure/data-factory/how-to-use-azure-key-vault-secrets-pipeline-activities?source=recommendations"">https://learn.microsoft.com/en-us/azure/data-factory/how-to-use-azure-key-vault-secrets-pipeline-activities?source=recommendations</a></p> "
source is Azure Data Factory	Azure Data Factory	Credentials and secrets used in Azure Data Factory pipeline activities may be exposed due to failure to handle them security	Information Disclosure	"<p>Ensure the SecureOutput property is set to true in Azure Data Factory activity policy definitions to prevent secrets and credentials from being written to monitoring logs.</p>

"	"<p>Pipelines and activities Azure Data Factory - Activity policy JSON definition: <a href=""https://learn.microsoft.com/en-us/azure/data-factory/concepts-pipelines-activities?tabs=data-factory#activity-policy-json-definition"">https://learn.microsoft.com/en-us/azure/data-factory/concepts-pipelines-activities?tabs=data-factory#activity-policy-json-definition</a></p> "
target is Azure Data Factory	Azure Data Factory	Sensitive data may be disclosed due to failure to use suitable encryption-in-transit between Azure Data Factory and data sources.	Information Disclosure	"<p>Ensure pipelines are configured to require encryption-in-transit using protocols compliant with the Cryptography Security Policy.</p>

"	"<p>Security considerations for data movement in Azure Data Factory: <a href=""https://learn.microsoft.com/en-gb/azure/data-factory/data-movement-security-considerations#data-encryption-in-transit"">https://learn.microsoft.com/en-gb/azure/data-factory/data-movement-security-considerations#data-encryption-in-transit</a></p> "
target is Azure Data Lake Storage	Azure Data Lake Storage	Failure to enforce secure protocols for data encryption-in-transit with Azure Data Lake Storage may lead to data disclosure.	Information Disclosure	"<p>While Azure Storage uses TLS 1.2 on public HTTPS endpoints, TLS 1.0 and TLS 1.1 are still supported for backward compatibility.</p>
<p>To ensure clients do not connect with protocols that do not comply with the Cryptography Security Policy a minimum TLS version should be enforced.</p>
"	"<p>Enforce a minimum required version of Transport Layer Security (TLS) for requests to a storage account: <a href=""https://docs.microsoft.com/azure/storage/common/transport-layer-security-configure-minimum-version?tabs=portal"">https://docs.microsoft.com/azure/storage/common/transport-layer-security-configure-minimum-version?tabs=portal</a></p> 
"
target is Azure Data Lake Storage	Azure Data Lake Storage	Data may be exfiltrated from Azure Data Lake Storage due to failure to monitor for anomalous activity.	Information Disclosure	"<p>Defender for Storage continually analyzes the telemetry stream generated by the Azure Blob Storage and Azure Files services. When potentially malicious activities are detected, security alerts are generated. These alerts are displayed in Microsoft Defender for Cloud, together with the details of the suspicious activity along with the relevant investigation steps, remediation actions, and security recommendations.</p>
<p>Microsoft Defender for Storage is built into Microsoft Defender for Cloud. When you enable Microsoft Defender for Cloud's enhanced security features on your subscription, Microsoft Defender for Storage is automatically enabled for all of your storage accounts. You may enable or disable Defender for Storage for individual storage accounts under a specific subscription.</p>"	"<p>Configure Microsoft Defender for Storage: <a href=""https://docs.microsoft.com/azure/storage/common/azure-defender-storage-configure?tabs=azure-security-center"">https://docs.microsoft.com/azure/storage/common/azure-defender-storage-configure?tabs=azure-security-center</a></p> "
target is Azure Data Lake Storage	Azure Data Lake Storage	An adversary can abuse an insecure communication channel between a client and Azure Data Lake Storage.	Information Disclosure	"<p>Ensure that communication to Azure Storage is over HTTPS. It is recommended to enable the secure transfer required option to force communication with Azure Storage to be over HTTPS.</p>
"	"<p>Require secure transfer to ensure secure connections:  <a href=""https://learn.microsoft.com/en-us/azure/storage/common/storage-require-secure-transfer"">https://learn.microsoft.com/en-us/azure/storage/common/storage-require-secure-transfer</a></p>
<p>Use Client-Side Encryption to store sensitive data in Azure Storage.: <a href=""https://aka.ms/tmt-th65"">https://aka.ms/tmt-th65</a></p> "
target is Azure Data Lake Storage	Azure Data Lake Storage	An adversary can read sensitive data by sniffing unencrypted SMB traffic to Azure Data Lake Storage.	Information Disclosure	"<p>Use SMB 3.0 compatible client to ensure in-transit data encryption to Azure File Shares.</p>
"	"<p>Azure File Storage: <a href=""https://aka.ms/tmt-th19a"">https://aka.ms/tmt-th19a</a></p>
<p>Security recommendations for Blob storage: <a href=""https://aka.ms/tmt-th19b"">https://aka.ms/tmt-th19b</a></p> "
target is Azure Key Vault	Azure Key Vault	An attacker may be able to gain access using stolen credentials due to failure to rotate keys	Information Disclosure	"<p>Check for Microsoft Azure Key Vault keys that are about to expire soon and rotate them by creating a new version of these keys.</p>

<p>The expiration date attribute configured for an encryption key identifies the expiration time after which the Azure Key Vault key must not be used anymore for cryptographic operations. By following the cloud security best practices, all Microsoft Azure Key Vault keys must have an explicit expiration time, so that these keys can be renewed once these reach the end of their assigned lifetime. To meet security and compliance requirements within your organization, the Azure Key Vault keys must be renewed prior to their expiration date.</p>

"	"<p>Azure Key Vault basic concepts: <a href=""https://docs.microsoft.com/en-us/azure/key-vault/basic-concepts"">https://docs.microsoft.com/en-us/azure/key-vault/basic-concepts</a></p>
<p>CIS Microsoft Azure Foundations: <a href=""https://azure.microsoft.com/mediahandler/files/resourcefiles/cis-microsoft-azure-foundations-security-benchmark/CIS_Microsoft_Azure_Foundations_Benchmark_v1.0.0.pdf"">https://azure.microsoft.com/mediahandler/files/resourcefiles/cis-microsoft-azure-foundations-security-benchmark/CIS_Microsoft_Azure_Foundations_Benchmark_v1.0.0.pdf</a></p>

<p>Azure CLI Documentation:</p>
<p>az keyvault key: <a href=""https://docs.microsoft.com/en-us/cli/azure/keyvault/key?view=azure-cli-latest"">https://docs.microsoft.com/en-us/cli/azure/keyvault/key?view=azure-cli-latest</a></p>
<p>az keyvault list: <a href=""https://docs.microsoft.com/en-us/cli/azure/keyvault?view=azure-cli-latest#az-keyvault-list"">https://docs.microsoft.com/en-us/cli/azure/keyvault?view=azure-cli-latest#az-keyvault-list</a></p>
<p>az keyvault key list: <a href=""https://docs.microsoft.com/en-us/cli/azure/keyvault/key?view=azure-cli-latest#az-keyvault-key-list"">https://docs.microsoft.com/en-us/cli/azure/keyvault/key?view=azure-cli-latest#az-keyvault-key-list</a></p>
<p>az keyvault key show: <a href=""https://docs.microsoft.com/en-us/cli/azure/keyvault/key?view=azure-cli-latest#az-keyvault-key-show"">https://docs.microsoft.com/en-us/cli/azure/keyvault/key?view=azure-cli-latest#az-keyvault-key-show</a></p>
<p>az keyvault key set-attributes: <a href=""https://docs.microsoft.com/en-us/cli/azure/keyvault/key?view=azure-cli-latest#az-keyvault-key-set-attributes"">https://docs.microsoft.com/en-us/cli/azure/keyvault/key?view=azure-cli-latest#az-keyvault-key-set-attributes</a></p> "
target is Azure Key Vault	Azure Key Vault	Unauthorised access attempts may be made on Azure Key Vault if access from other Azure subscriptions is not restricted	Information Disclosure	"<p>Ensure that your Microsoft Azure key vaults are configured to allow access only to trusted Azure subscription in order to protect against unauthorized access. This approach strengthens security by minimizing the risk of unauthorized access to sensitive data stored in Azure key vaults.</p>

<p>It is crucial to avoid cross-subscription access to Azure Key Vault in order to maintain robust security boundaries and prevent unauthorized access to sensitive cryptographic materials. Allowing key vault resources to be accessed from different subscriptions can increase the risk of data breaches by broadening the attack surface and potentially exposing cryptographic assets to unauthorized users or services in other subscriptions.</p>

"	"<p>Azure Key Vault security: <a href=""https://docs.microsoft.com/en-us/azure/key-vault/overview-security"">https://docs.microsoft.com/en-us/azure/key-vault/overview-security</a></p>
<p>Azure role-based access control (Azure RBAC) vs. access policies (legacy): <a href=""https://learn.microsoft.com/en-us/azure/key-vault/general/rbac-access-policy"">https://learn.microsoft.com/en-us/azure/key-vault/general/rbac-access-policy</a></p>
<p>Provide access to Key Vault keys, certificates and secrets with an Azure role-based access control: <a href=""https://learn.microsoft.com/en-us/azure/key-vault/general/rbac-guide?tabs=azure-cli"">https://learn.microsoft.com/en-us/azure/key-vault/general/rbac-guide?tabs=azure-cli</a></p>

<p>Azure CLI Documentation:</p>
<p>az account list: <a href=""https://docs.microsoft.com/en-us/cli/azure/account?view=azure-cli-latest#az-account-list"">https://docs.microsoft.com/en-us/cli/azure/account?view=azure-cli-latest#az-account-list</a></p>
<p>az keyvault list: <a href=""https://docs.microsoft.com/en-us/cli/azure/keyvault?view=azure-cli-latest#az-keyvault-list"">https://docs.microsoft.com/en-us/cli/azure/keyvault?view=azure-cli-latest#az-keyvault-list</a></p>
<p>az role assignment list: <a href=""https://learn.microsoft.com/en-us/cli/azure/role/assignment?view=azure-cli-latest#az-role-assignment-list"">https://learn.microsoft.com/en-us/cli/azure/role/assignment?view=azure-cli-latest#az-role-assignment-list</a></p>
<p>az role assignment delete: <a href=""https://learn.microsoft.com/en-us/cli/azure/role/assignment?view=azure-cli-latest#az-role-assignment-delete"">https://learn.microsoft.com/en-us/cli/azure/role/assignment?view=azure-cli-latest#az-role-assignment-delete</a></p> "
target is Azure Key Vault and  ( target.Credential Type is 'Certificates' or  target.Credential Type is 'Secrets and Certificates' )	Azure Key Vault	Failure to set an appropriate minimum key size for Azure Key Vault RSA certificates may lead to information disclosure	Information Disclosure	"<p>Ensure that your Microsoft Azure Key Vault RSA certificates are generated with a minimum key size of 2048 bits as specified by the Cryptography Security Policy.</p>

<p>For most cryptographic functions, the key size (key length) is an important security parameter. Having the right key size set for your Azure Key Vault RSA certificates will enforce security best practices as specified in the compliance regulations implemented within your organization. For example, if your RSA certificates are used for applications that process and transfer highly sensitive and confidential data, you can enforce a key size of 4096 bits.</p>

"	"<p>About keys, secrets, and certificates: <a href=""https://docs.microsoft.com/en-us/azure/key-vault/general/about-keys-secrets-certificates"">https://docs.microsoft.com/en-us/azure/key-vault/general/about-keys-secrets-certificates</a></p>
<p>Get started with Key Vault certificates: <a href=""https://docs.microsoft.com/en-us/azure/key-vault/certificates/certificate-scenarios"">https://docs.microsoft.com/en-us/azure/key-vault/certificates/certificate-scenarios</a></p>
<p>Cryptography Security Policy <a href=""https://jsainsbury.sharepoint.com/sites/OurSainsburys-DoingYourJob/SitePages/Information-Security.aspx#policies"">https://jsainsbury.sharepoint.com/sites/OurSainsburys-DoingYourJob/SitePages/Information-Security.aspx#policies</a></p>

<p>Azure CLI Documentation:</p>
<p>az keyvault list: <a href=""https://docs.microsoft.com/en-us/cli/azure/keyvault?view=azure-cli-latest#az-keyvault-list"">https://docs.microsoft.com/en-us/cli/azure/keyvault?view=azure-cli-latest#az-keyvault-list</a></p>
<p>az keyvault certificate list: <a href=""https://docs.microsoft.com/en-us/cli/azure/keyvault/certificate?view=azure-cli-latest#az-keyvault-certificate-list"">https://docs.microsoft.com/en-us/cli/azure/keyvault/certificate?view=azure-cli-latest#az-keyvault-certificate-list</a></p>
<p>az keyvault certificate show: <a href=""https://docs.microsoft.com/en-us/cli/azure/keyvault/certificate?view=azure-cli-latest#az-keyvault-certificate-list"">https://docs.microsoft.com/en-us/cli/azure/keyvault/certificate?view=azure-cli-latest#az-keyvault-certificate-list</a></p>
<p>az keyvault certificate set-attributes: <a href=""https://docs.microsoft.com/en-us/cli/azure/keyvault/certificate?view=azure-cli-latest#az-keyvault-certificate-set-attributes"">https://docs.microsoft.com/en-us/cli/azure/keyvault/certificate?view=azure-cli-latest#az-keyvault-certificate-set-attributes</a></p> "
target is Azure Key Vault and  ( target.Credential Type is 'Certificates' or  target.Credential Type is 'Secrets and Certificates' )	Azure Key Vault	Failure to restrict allowed key types for Azure Key Vault SSL certificates could lead to information disclosure	Information Disclosure	"<p>Ensure that your Microsoft Azure Key Vault SSL certificates are using the allowed key type(s) for security and compliance purposes.</p>

<p>Having the right key type set for your Azure Key Vault SSL certificates will enforce the best practices as specified in the security and compliance regulations implemented within the Cryptography Security Policy.</p>

"	"<p>About keys, secrets, and certificates: <a href=""https://docs.microsoft.com/en-us/azure/key-vault/general/about-keys-secrets-certificates"">https://docs.microsoft.com/en-us/azure/key-vault/general/about-keys-secrets-certificates</a></p>
<p>Get started with Key Vault certificates: <a href=""https://docs.microsoft.com/en-us/azure/key-vault/general/about-keys-secrets-certificates"">https://docs.microsoft.com/en-us/azure/key-vault/general/about-keys-secrets-certificates</a></p>
<p>Manage certificates via Azure Key Vault: <a href=""https://docs.microsoft.com/en-us/archive/blogs/kv/manage-certificates-via-azure-key-vault"">https://docs.microsoft.com/en-us/archive/blogs/kv/manage-certificates-via-azure-key-vault</a></p>
<p>Cryptography Security Policy <a href=""https://jsainsbury.sharepoint.com/sites/OurSainsburys-DoingYourJob/SitePages/Information-Security.aspx#policies"">https://jsainsbury.sharepoint.com/sites/OurSainsburys-DoingYourJob/SitePages/Information-Security.aspx#policies</a></p>

<p>Azure CLI Documentation:</p>
<p>az keyvault list: <a href=""https://docs.microsoft.com/en-us/cli/azure/keyvault?view=azure-cli-latest#az-keyvault-list"">https://docs.microsoft.com/en-us/cli/azure/keyvault?view=azure-cli-latest#az-keyvault-list</a></p>
<p>az keyvault certificate list: <a href=""https://docs.microsoft.com/en-us/cli/azure/keyvault/certificate?view=azure-cli-latest#az-keyvault-certificate-list"">https://docs.microsoft.com/en-us/cli/azure/keyvault/certificate?view=azure-cli-latest#az-keyvault-certificate-list</a></p>
<p>az keyvault certificate show: <a href=""https://docs.microsoft.com/en-us/cli/azure/keyvault/certificate?view=azure-cli-latest#az-keyvault-certificate-show"">https://docs.microsoft.com/en-us/cli/azure/keyvault/certificate?view=azure-cli-latest#az-keyvault-certificate-show</a></p>
<p>az keyvault certificate set-attributes: <a href=""https://docs.microsoft.com/en-us/cli/azure/keyvault/certificate?view=azure-cli-latest#az-keyvault-certificate-set-attributes"">https://docs.microsoft.com/en-us/cli/azure/keyvault/certificate?view=azure-cli-latest#az-keyvault-certificate-set-attributes</a></p> "
( target is Azure Key Vault ) and  (target.Credential Type is 'Secrets and Certificates' or  target.Credential Type is 'Certificates')	Azure Key Vault	Failure to securely manage certificate lifecycle in Azure Key Vault may lead to data disclosure	Information Disclosure	"<p>Follow the Azure Key Vault best practice to securely manage your certificate lifecycle in the key vault. This includes the key creation/import, rotation, revocation, storage, and purge of the certificate.</p>

"	"<p>Azure Key Vault certificate management: <a href=""https://docs.microsoft.com/azure/key-vault/certificates/create-certificate-scenarios"">https://docs.microsoft.com/azure/key-vault/certificates/create-certificate-scenarios</a></p> "
( target is Azure Key Vault ) and  ( target.Credential Type is 'Secrets' or  target.Credential Type is 'Secrets and Certificates' )	Azure Key Vault	Failure to securely manage key lifecycles in Azure Key Vault may lead to data disclosure.	Information Disclosure	"<p>Follow the Azure Key Vault best practices to securely manage your key lifecycle in key vault. This includes the key generation, distribution, storage, rotation, and revocation.</p>
"	"<p>Azure Key Vault key management: <a href=""https://docs.microsoft.com/azure/key-vault/keys/about-keys-details#key-access-control"">https://docs.microsoft.com/azure/key-vault/keys/about-keys-details#key-access-control</a></p> "
target is Azure Storage Account	Azure Storage Account	Failure to enforce secure protocols for data encryption-in-transit may lead to data disclosure.	Information Disclosure	"<p>While Azure Storage uses TLS 1.2 on public HTTPS endpoints, TLS 1.0 and TLS 1.1 are still supported for backward compatibility.</p>

<p>To ensure clients do not connect with protocols that do not comply with the Cryptography Security Policy a minimum TLS version should be enforced.</p>"	"<p>Enforce a minimum required version of Transport Layer Security (TLS) for requests to a storage account: <a href=""https://docs.microsoft.com/azure/storage/common/transport-layer-security-configure-minimum-version?tabs=portal"">https://docs.microsoft.com/azure/storage/common/transport-layer-security-configure-minimum-version?tabs=portal</a></p> "
target is Azure Storage Account	Azure Storage Account	Data may be exfiltrated from a storage account undetected due to failure to monitor for anomalous activity.	Information Disclosure	"<p>Defender for Storage continually analyzes the telemetry stream generated by the Azure Blob Storage and Azure Files services. When potentially malicious activities are detected, security alerts are generated. These alerts are displayed in Microsoft Defender for Cloud, together with the details of the suspicious activity along with the relevant investigation steps, remediation actions, and security recommendations.</p>

<p>Microsoft Defender for Storage is built into Microsoft Defender for Cloud. When you enable Microsoft Defender for Cloud's enhanced security features on your subscription, Microsoft Defender for Storage is automatically enabled for all of your storage accounts. You may enable or disable Defender for Storage for individual storage accounts under a specific subscription.</p>"	"<p>Configure Microsoft Defender for Storage: <a href=""https://docs.microsoft.com/azure/storage/common/azure-defender-storage-configure?tabs=azure-security-center"">https://docs.microsoft.com/azure/storage/common/azure-defender-storage-configure?tabs=azure-security-center</a></p>"
target is Azure API Management	Azure API Management	"An adversary can deny performing acts on {target.Name} due to a lack of auditing, leading to repudiation issues."	Repudiation	"<p>Enable resource logs for API Management, resource logs provide rich information about operations and errors that are important for auditing and troubleshooting purposes. Categories of resource logs for API Management include:</p>

<p>- GatewayLogs<br/>
- WebSocketConnectionLogs</p>

<p>Resource logs can be configured to collect the required information and send them to a data sink such as a storage account or log analytics workspace.</p>

"	"<p>APIM Resource Logs:  <a href=""https://docs.microsoft.com/azure/api-management/api-management-howto-use-azure-monitor#resource-logs"">https://docs.microsoft.com/azure/api-management/api-management-howto-use-azure-monitor#resource-logs</a></p>
"
target is Azure Data Factory	Azure Data Factory	An adversary can deny performing acts on Azure Data Factory due to lack of auditing leading to repudiation issues.	Repudiation	<p>Activity logs are available automatically and these should be actively monitored to detect events such as resources being modified.  Microsoft Defender for Cloud and Azure Policy can be used to enable resources logs and log data collection.  Azure Data Factory resource logs are not collected by Azure Monitor until they are routed to a destination.</p>	"<p>Diagnostic settings in Azure Monitor:  <a href=""https://learn.microsoft.com/en-gb/azure-monitor/essentials/diagnostic-settings"">https://learn.microsoft.com/en-gb/azure-monitor/essentials/diagnostic-settings</a></p>
<p>Supported Resource log categories for Azure monitor: <a href=""https://learn.microsoft.com/en-us/azure/azure-monitor/reference/logs-index"">https://learn.microsoft.com/en-us/azure/azure-monitor/reference/logs-index</a></p>"
target is Azure Data Lake Storage	Azure Data Lake Storage	An adversary can deny actions on Azure Data Lake Storage due to failure to audit leading to repudiation issues.	Repudiation	"<p>Ingest logs via Azure Monitor to aggregate security data generated by endpoint devices, network resources, and other security systems.  Resource logs are not collected by Azure Monitor until they are routed to a destination.</p>"	"<p>Monitoring Azure Blob Storage:  <a href=""https://docs.microsoft.com/azure/storage/blobs/monitor-blob-storage"">https://docs.microsoft.com/azure/storage/blobs/monitor-blob-storage</a></p>
<p>Diagnostic settings in Azure Monitor:  <a href=""https://learn.microsoft.com/en-gb/azure/azure-monitor/essentials/diagnostic-settings"">https://learn.microsoft.com/en-gb/azure/azure-monitor/essentials/diagnostic-settings</a></p>
<p>Supported Resource log categories for Azure Monitor:  <a href=""https://learn.microsoft.com/en-us/azure/azure-monitor/reference/logs-index"">https://learn.microsoft.com/en-us/azure/azure-monitor/reference/logs-index</a></p> "
target is Azure Data Lake Storage	Azure Data Lake Storage	An adversary can deny actions on Azure Data Lake Storage due to lack of auditing.	Repudiation	"<p>Proper logging of all security events and user actions builds traceability in a system and denies any possible repudiation issues. In the absence of proper auditing and logging controls, it would become impossible to implement any accountability in a system.</p>
"	"<p>Use Azure Storage Analytics to audit access of Azure Storage. If possible, audit the calls to the Azure Storage instance at the source of the call: <a href=""https://aka.ms/tmt-th20"">https://aka.ms/tmt-th20</a></p> "
target is Azure Key Vault	Azure Key Vault	An unauthorised user can deny making unsolicited changes to Azure Key Vault	Repudiation	"<p>Ensure that an Azure activity log alert is fired whenever ""Update Key Vault"" events are triggered within your Microsoft Azure cloud account. Activity log alerts get triggered when a new activity log event that matches the condition specified in the alert configuration occurs. For this conformity rule, the matched condition is ""Whenever the Activity Log has an event with Category='Administrative', Signal name='Update Key Vault (vaults)'"".</p>

<p>Monitoring your Microsoft Azure account for ""Update Key Vault"" events will give you insights into the configuration changes made at the Azure Key Vault level and help you reduce the time it takes to detect any unauthorized activity performed on the resource and mitigate all unwanted behavior.</p>

"	"<p>Azure Key Vault logging: <a href=""https://docs.microsoft.com/azure/key-vault/general/logging?tabs=Vault"">https://docs.microsoft.com/azure/key-vault/general/logging?tabs=Vault</a></p>
<p>Create, view, and manage activity log alerts by using Azure Monitor: <a href=""https://docs.microsoft.com/en-us/azure/azure-monitor/platform/alerts-activity-log"">https://docs.microsoft.com/en-us/azure/azure-monitor/platform/alerts-activity-log</a></p>
<p>Create, view, and manage log alerts using Azure Monitor: <a href=""https://docs.microsoft.com/en-us/azure/azure-monitor/platform/alerts-activity-log"">https://docs.microsoft.com/en-us/azure/azure-monitor/platform/alerts-activity-log</a></p>
<p>Supported Resource log categories for Azure Monitor:  <a href=""https://learn.microsoft.com/en-us/azure-monitor/reference/logs-index"">https://learn.microsoft.com/en-us/azure-monitor/reference/logs-index</a></p>
<p>Action rules (preview): <a href=""https://docs.microsoft.com/en-us/azure/azure-monitor/platform/alerts-action-rules"">https://docs.microsoft.com/en-us/azure/azure-monitor/platform/alerts-action-rules</a></p>

<p>Azure CLI Documentation</p>
<p>az monitor activity-log alert list: <a href=""https://docs.microsoft.com/en-us/cli/azure/monitor/activity-log/alert?view=azure-cli-latest#az-monitor-activity-log-alert-list"">https://docs.microsoft.com/en-us/cli/azure/monitor/activity-log/alert?view=azure-cli-latest#az-monitor-activity-log-alert-list</a></p>
<p>az monitor activity-log alert show: <a href=""https://docs.microsoft.com/en-us/cli/azure/monitor/activity-log/alert?view=azure-cli-latest#az-monitor-activity-log-alert-list"">https://docs.microsoft.com/en-us/cli/azure/monitor/activity-log/alert?view=azure-cli-latest#az-monitor-activity-log-alert-list</a></p>
<p>az monitor activity-log alert create: <a href=""https://docs.microsoft.com/en-us/cli/azure/monitor/activity-log/alert?view=azure-cli-latest#az-monitor-activity-log-alert-create"">https://docs.microsoft.com/en-us/cli/azure/monitor/activity-log/alert?view=azure-cli-latest#az-monitor-activity-log-alert-create</a></p>"
target is Azure Storage Account	Azure Storage Account	An adversary can deny actions on Azure Storage Account due to failure to audit leading to repudiation issues.	Repudiation	"<p>Ingest logs via Azure Monitor to aggregate security data generated by endpoint devices, network resources, and other security systems.  Resource logs are not collected by Azure Monitor until they are routed to a destination.</p>

"	"<p>Monitoring Azure Blob Storage:  <a href=""https://docs.microsoft.com/azure/storage/blobs/monitor-blob-storage"">https://docs.microsoft.com/azure/storage/blobs/monitor-blob-storage</a></p>
<p>Diagnostic settings in Azure Monitor:  <a href=""https://learn.microsoft.com/en-gb/azure/azure-monitor/essentials/diagnostic-settings"">https://learn.microsoft.com/en-gb/azure/azure-monitor/essentials/diagnostic-settings</a></p>
<p>Supported Resource log categories for Azure Monitor:  <a href=""https://learn.microsoft.com/en-us/azure/azure-monitor/reference/logs-index"">https://learn.microsoft.com/en-us/azure/azure-monitor/reference/logs-index</a></p> "
target is Azure API Management	Azure API Management	Use of weak authentication methods for Azure API Management service instances may allow attackers to intercept and modify API calls	Spoofing	"<p>Avoid the use of local authentication methods or accounts, these should be disabled wherever possible.  Instead use Entra ID to authenticate.</p>

<p>Use OAuth 2.0 authorisation with Microsoft Entra ID to authenticate users or applications to an API, this uses OAuth and JWT tokens to authenticate and authorise requests passed to the API.</p>

<p>Extra security can be achieved by configuring Azure API Management service instances to use client certificates for authentication, establishing trust between API clients and Azure API Management.</p>

<p>Securing access to Azure API Management services using client certificates provides an additional layer of authentication and ensures that only authorized clients with the correct certificates can access the APIs, enhancing overall security and protecting sensitive data. Using client certificates makes it much more difficult for attackers to intercept and modify API calls.</p>"	"<p>Protect an API in Azure API Management using OAuth 2.0 authorization with Microsoft Entra ID: <a href=""https://learn.microsoft.com/en-gb/azure/api-management/api-management-howto-protect-backend-with-aad"">https://learn.microsoft.com/en-gb/azure/api-management/api-management-howto-protect-backend-with-aad</a></p>
<p>Authentication and authorization to APIs in Azure API Management: <a href=""https://learn.microsoft.com/en-us/azure/api-management/authentication-authorization-overview"">https://learn.microsoft.com/en-us/azure/api-management/authentication-authorization-overview</a></p>
<p>How to secure APIs using client certificate authentication in API Management: <a href=""https://learn.microsoft.com/en-us/azure/api-management/api-management-howto-mutual-certificates-for-clients"">https://learn.microsoft.com/en-us/azure/api-management/api-management-howto-mutual-certificates-for-clients</a></p>
<p>Validate client certificate: <a href=""https://learn.microsoft.com/en-us/azure/api-management/validate-client-certificate-policy"">https://learn.microsoft.com/en-us/azure/api-management/validate-client-certificate-policy</a></p> "
target is Azure API Management	Azure API Management	An unauthorised user may gain access to the Azure API Management Developer Portal	Spoofing	"<p>Ensure that your Azure API Management API services are configured to automatically enable a Microsoft Entra ID application and identity provider for users of the Developer Portal. The Developer Portal in Azure API Management is an automatically generated, fully customizable website that serves as a central hub for developers to discover, understand, and consume APIs. It provides comprehensive API documentation, interactive code samples, and secure access to APIs.</p>

<p>User sign-in with Microsoft Entra ID for Developer Portal in Azure API Management ensures secure authentication, seamless integration with existing organizational identities, and fine-grained access control. It simplifies user management, enhances security, and provides a unified experience for developers using APIs.</p>"	"<p>Authorise developer accounts by using Microsoft Entra ID in Azure API Management: <a href=""https://learn.microsoft.com/en-us/azure/api-management/api-management-howto-aad"">https://learn.microsoft.com/en-us/azure/api-management/api-management-howto-aad</a></p>
<p>Tutorial - Access and customise the developer portal: <a href=""https://learn.microsoft.com/en-us/azure/api-management/api-management-howto-developer-portal-customize"">https://learn.microsoft.com/en-us/azure/api-management/api-management-howto-developer-portal-customize</a></p> "
target is Azure API Management	Azure API Management	Using service principals or basic authentication for services connecting to {target.name} may lead to credentials being exposed in code or through poor storage and management.	Spoofing	"<p>Use a Managed Service Identity generated by Azure Active Directory (Azure AD) to allow your API Management instance to easily and securely access other Azure AD-protected resources, such as Azure Key Vault instead of using service principals. Managed identity credentials are fully managed, rotated, and protected by the platform, avoiding hard-coded credentials in source code or configuration files.</p>"	"<p>Authenticate with managed identity: <a href=""https://docs.microsoft.com/azure/api-management/api-management-authentication-policies#ManagedIdentity"">https://docs.microsoft.com/azure/api-management/api-management-authentication-policies#ManagedIdentity</a></p>"
source is Azure Data Factory	Azure Data Factory	Attackers may be able to gain unauthorised access to the data plane due to use of weak authentication for Azure Data Factory	Spoofing	"<p>Use managed identities when authenticating Data Factory with Azure services and resources that support Azure AD authentication.  Ensure the ""identity"" keyword is used when using the SDK or REST API to create a data factory.</p>

"	"<p>Managed identity for Azure Data Factory: <a href=""https://learn.microsoft.com/en-us/azure/data-factory/data-factory-service-identity"">https://learn.microsoft.com/en-us/azure/data-factory/data-factory-service-identity</a></p>"
source is Azure Data Factory	Azure Data Factory	Credentials may be exposed if system-assigned Managed Identities are not used to authenticate Azure Data Factory when connecting to other Azure resources.	Spoofing	"<p>Managed identities eliminate the need to manage credentials.  Managed identities provide an identity for the service instance when connecting to resources that support Microsoft Entra Authentication.</p>

<p>If Azure Data Factory is assigned a system-assigned managed identity then this can be used to facilitate access to Azure Storage and Azure Key Vault as a trusted service.</p>"	"<p>What are managed identities for Azure resources?: <a href=""https://learn.microsoft.com/en-gb/entra/identity/managed-identities-azure-resources/overview"">https://learn.microsoft.com/en-gb/entra/identity/managed-identities-azure-resources/overview</a></p>
<p>Managed identity for Azure Data Factory: <a href=""https://learn.microsoft.com/en-gb/azure/data-factory/data-factory-service-identity"">https://learn.microsoft.com/en-gb/azure/data-factory/data-factory-service-identity</a></p>
<p>Data Factory is now a 'Trusted Service' in Azure Storage and Azure Key Vault firewall: <a href=""https://techcommunity.microsoft.com/blog/azuredatafactoryblog/data-factory-is-now-a-trusted-service-in-azure-storage-and-azure-key-vault-firew/964993"">https://techcommunity.microsoft.com/blog/azuredatafactoryblog/data-factory-is-now-a-trusted-service-in-azure-storage-and-azure-key-vault-firew/964993</a></p> "
target is Azure Data Lake Storage	Azure Data Lake Storage	An adversary may be able to access Azure Data Lake Storage objects anonymously.	Spoofing	"<p>An adversary can gain access to Azure storage containers and blobs if anonymous access is provided to potentially sensitive data accidentally.  By default, anonymous access is not permitted unless it is explicitly enabled.</p>"	"<p>Overview: Remediating anonymous read access for blob data: <a href=""https://learn.microsoft.com/en-gb/azure/storage/blobs/anonymous-read-access-overview"">https://learn.microsoft.com/en-gb/azure/storage/blobs/anonymous-read-access-overview</a></p>
<p>Ensure that only the required containers and blobs are given anonymous read access: <a href=""https://aka.ms/tmt-th85"">https://aka.ms/tmt-th85</a></p>"
target is Azure Data Lake Storage	Azure Data Lake Storage	Weak authentication may lead to Azure Data Lake Storage being accessed by an unauthorised user or resource.	Spoofing	"<p>For optimal security and ease of use it is recommended to use Microsoft Entra credentials with managed identities to authorise requests to data in Azure Storage.</p>
<p>Shared Key authorisation should be disallowed for storage accounts and shared access signatures (SAS) should only be used if necessary, and for limited delegated access to blob resources.</p>
<p>Grant limited access to objects in Azure Storage using Shared Access Signatures (SAS) with a Stored Access Policy (SAP). It is recommended to scope SAS and SAP to permit only the necessary permissions over a short period of time.</p>
<p>A service SAS that is not associate with a stored access policy cannot be revoked.  For this reason, it is recommended to limit the expiry time so that the SAS is valid for one hour or less.</p>"	"<p>Authorize access to data in Azure Storage:  <a href=""https://learn.microsoft.com/en-gb/azure/storage/common/authorize-data-access"">https://learn.microsoft.com/en-gb/azure/storage/common/authorize-data-access</a></p>
<p>Authorize access to blobs using Microsoft Entra ID: <a href=""https://learn.microsoft.com/en-gb/azure/storage/blobs/authorize-access-azure-active-directory"">https://learn.microsoft.com/en-gb/azure/storage/blobs/authorize-access-azure-active-directory</a></p>
<p>Authorize access to queues using Microsoft Entra ID: <a href=""https://learn.microsoft.com/en-gb/azure/storage/queues/authorize-access-azure-active-directory"">https://learn.microsoft.com/en-gb/azure/storage/queues/authorize-access-azure-active-directory</a></p>
<p>Authorize access to tables using Microsoft Entra ID: <a href=""https://learn.microsoft.com/en-gb/azure/storage/tables/authorize-access-azure-active-directory"">https://learn.microsoft.com/en-gb/azure/storage/tables/authorize-access-azure-active-directory</a></p>
<p>Disallow Shared Key authorization: <a href=""https://learn.microsoft.com/en-gb/azure/storage/common/shared-key-authorization-prevent"">https://learn.microsoft.com/en-gb/azure/storage/common/shared-key-authorization-prevent</a></p>
<p>Using Shared Access Signatures (SAS): <a href=""https://learn.microsoft.com/en-gb/azure/storage/common/storage-sas-overview"">https://learn.microsoft.com/en-gb/azure/storage/common/storage-sas-overview</a></p>
<p>Grant limited access to Azure Storage resources using shared access signatures (SAS): <a href=""https://aka.ms/tmt-th17a"">https://aka.ms/tmt-th17a</a></p>
<p>Define a stored access policy: <a href=""https://learn.microsoft.com/en-us/rest/api/storageservices/define-stored-access-policy"">https://learn.microsoft.com/en-us/rest/api/storageservices/define-stored-access-policy</a></p>
<p>SFTP permission model: <a href=""https://docs.microsoft.com/azure/storage/blobs/secure-file-transfer-protocol-support#sftp-permission-model"">https://docs.microsoft.com/azure/storage/blobs/secure-file-transfer-protocol-support#sftp-permission-model</a></p> "
target is Azure API Management	Azure API Management	Unauthorised users may be able to access Azure API Management APIs due to failure to restrict allowed IP addresses or block public access.	Tampering	"<p>To safeguard your Azure API Management APIs from unauthorized access, it is imperative to implement network access restrictions based on IP addresses. This requires configuring your APIs to accept requests from authorized IP addresses or designated IP address ranges. API Management supports disabling public network access either through using service-level IP filtering rules  or using a 'Disable Public Network Access' toggle switch.</p>

<p>Deploy Azure API Management inside an Azure Virtual Network (VNET) so it can access backend services within the network.  The developer portal and API Management gateway can be configured to be accessible either from the Internet (External) or only within the VNet (Internal).</p>

<p>A private endpoint should be used to secure incoming connections from Azure resources that support Private Link.  Incoming traffic should be limited to private endpoints only to prevent data exfiltration.</p>

<p>Network security groups (NSGs) can be deployed to API Management subnets to restrict or monitor traffic by port, protocol, source IP address, or destination IP address.  Create NSG rules to restrict your service's open ports (such as preventing management ports from being accessed by untrusted networks).  Unrestricted network access, which permits connections from all IP addresses, is not recommended. To configure the network (IP-based) access for your APIs, a built-in policy named ip-filter must be implemented at the API level.</p>

<p>By filtering incoming requests based on caller IP addresses in Azure API Management, you can proactively enhance security by preventing access from known malicious sources. This measure mitigates potential threats and ensures that only trusted, designated requests are allowed, minimizing the risk of unauthorized access or attacks on your API infrastructure.</p>"	"<p>Virtual network configuration reference: API Management: <a href=""https://learn.microsoft.com/en-gb/azure/api-management/virtual-network-reference"">https://learn.microsoft.com/en-gb/azure/api-management/virtual-network-reference</a></p>
<p>Use a virtual network with Azure API Management: <a href=""https://learn.microsoft.com/en-gb/azure/api-management/virtual-network-concepts"">https://learn.microsoft.com/en-gb/azure/api-management/virtual-network-concepts</a></p>
<p>Connect privately to API Management using an inbound private endpoint: <a href=""https://learn.microsoft.com/en-gb/azure/api-management/private-endpoint"">https://learn.microsoft.com/en-gb/azure/api-management/private-endpoint</a></p>
<p>How to set or edit Azure API Management policies: <a href=""https://learn.microsoft.com/en-us/azure/api-management/set-edit-policies?tabs=form"">https://learn.microsoft.com/en-us/azure/api-management/set-edit-policies?tabs=form</a></p>
<p>Restrict caller IPs: <a href=""https://learn.microsoft.com/en-us/azure/api-management/ip-filter-policy"">https://learn.microsoft.com/en-us/azure/api-management/ip-filter-policy</a></p>
<p>Disable Public Network Access: <a href=""https://docs.microsoft.com/azure/api-management/private-endpoint#optionally-disable-public-network-access"">https://docs.microsoft.com/azure/api-management/private-endpoint#optionally-disable-public-network-access</a></p>

<p>Azure PowerShell Documentation:</p>
<p>az apim list: <a href=""https://learn.microsoft.com/en-us/cli/azure/apim?view=azure-cli-latest#az-apim-list"">https://learn.microsoft.com/en-us/cli/azure/apim?view=azure-cli-latest#az-apim-list</a></p>
<p>az apim api list: <a href=""https://learn.microsoft.com/en-us/cli/azure/apim/api?view=azure-cli-latest#az-apim-api-list"">https://learn.microsoft.com/en-us/cli/azure/apim/api?view=azure-cli-latest#az-apim-api-list</a></p>
<p>New-AzApiManagementContext: <a href=""https://learn.microsoft.com/en-us/powershell/module/az.apimanagement/new-azapimanagementcontext?view=azps-11.0.0"">https://learn.microsoft.com/en-us/powershell/module/az.apimanagement/new-azapimanagementcontext?view=azps-11.0.0</a></p>
<p>Get-AzApiManagementPolicy: <a href=""https://learn.microsoft.com/en-us/powershell/module/az.apimanagement/get-azapimanagementpolicy?view=azps-11.1.0"">https://learn.microsoft.com/en-us/powershell/module/az.apimanagement/get-azapimanagementpolicy?view=azps-11.1.0</a></p>
<p>Set-AzApiManagementPolicy: <a href=""https://learn.microsoft.com/en-us/powershell/module/az.apimanagement/set-azapimanagementpolicy?view=azps-11.1.0"">https://learn.microsoft.com/en-us/powershell/module/az.apimanagement/set-azapimanagementpolicy?view=azps-11.1.0</a></p> "
target is Azure API Management	Azure API Management	Failure to enforce secure configuration across API management resources may allow attackers to compromise the infrastructure.	Tampering	"<p>Use built-in Azure Policy to monitor and enforce secure configuration across Azure Container Registry resources.  Use Azure Policy aliases in the ""Microsoft.ApiManagement"" namespace to create custom Azure Policy definitions where required.</p>

"	"<p>Audit compliance of Azure container registries using Azure Policy:  <a href=""https://learn.microsoft.com/en-gb/azure/container-registry/container-registry-azure-policy"">https://learn.microsoft.com/en-gb/azure/container-registry/container-registry-azure-policy</a></p> "
target is Azure API Management	Azure API Management	Failure to segregate network traffic to Azure API Management may allow attackers to compromise the infrastructure.	Tampering	"<p>Azure Application Gateway is a PaaS offering that acts as a Layer-7 load balancer and reverse-proxy service for access to Azure API Management.  Azure Application Gateway also proviced Azure Web Application Firewall services.</p>

"	"<p>Integrate API Management in an internal virtual network with Application Gateway: <a href=""https://learn.microsoft.com/en-gb/azure/api-management/api-management-howto-integrate-internal-vnet-appgateway"">https://learn.microsoft.com/en-gb/azure/api-management/api-management-howto-integrate-internal-vnet-appgateway</a></p> "
target is Azure Data Factory	Azure Data Factory	Failure to enforce secure configuration across Azure Data Factory resources may allow attackers to compromise the infrastructure.	Tampering	<p>Use Azure Policy to audit and restrict which services users can provision in your environment. Use Azure Resource Graph to query for and discover resources within subscriptions. You can also use Azure Monitor to create rules to trigger alerts when they detect an unapproved service.</p>	"<p>Azure Policy built-in definitions for Data Factory: <a href=""https://learn.microsoft.com/en-gb/azure/data-factory/policy-reference"">https://learn.microsoft.com/en-gb/azure/data-factory/policy-reference</a></p> "
(source is Azure Data Factory)	Azure Data Factory	An adversary may gain unauthorized access to {target.Name} if connection is insecure	Tampering	"<p>Use a self-hosted integration runtime to secure the connection between non-Azure data sources and Azure Data Factory.  Ensure the self-hosted integration runtime is installed on a Windows machine hardened to CIS Level 2 and kept regularly updated.</p>

<p>Configure a private endpoint for communication between a self-hosted integration runtime and Azure Data Factory.</p>

<p>Disable public network access (this needs to be done manually when private link is enabled with a self-hosted integration runtime).</p>"	"<p>Integration runtime in Azure Data Factory: <a href=""https://learn.microsoft.com/en-gb/azure/data-factory/concepts-integration-runtime"">https://learn.microsoft.com/en-gb/azure/data-factory/concepts-integration-runtime</a></p>

<p>Create and configure a self-hosted integration runtime: <a href=""https://learn.microsoft.com/en-gb/azure/data-factory/create-self-hosted-integration-runtime?tabs=data-factory"">https://learn.microsoft.com/en-gb/azure/data-factory/create-self-hosted-integration-runtime?tabs=data-factory</a></p>

<p>Azure Private Link for Azure Data Factory:  <a href=""https://learn.microsoft.com/en-gb/azure/data-factory/data-factory-private-link#configure-private-endpoint-for-communication-between-self-hosted-ir-and-data-factory"">https://learn.microsoft.com/en-gb/azure/data-factory/data-factory-private-link#configure-private-endpoint-for-communication-between-self-hosted-ir-and-data-factory</a></p>

<p>Note:  Issues may be encountered when using Parquet datasets with a self-hosted integration runtime.  For further details see <a href=""https://learn.microsoft.com/en-gb/azure/data-factory/format-parquet#using-self-hosted-integration-runtime"">https://learn.microsoft.com/en-gb/azure/data-factory/format-parquet#using-self-hosted-integration-runtime</a></p> "
target is Azure Data Lake Storage	Azure Data Lake Storage	An adversary may exploit weakly configured Azure Data Lake Storage to gain access.	Tampering	<p>Use Microsoft Defender for Storage to provide an additional layer of security intelligence that detects unusual and potentially harmful attempts to access or exploit storage accounts.  It uses advanced threat detection capabilities and Microsoft Threat Intelligence data to provide contextual security alerts. Those alerts also include steps to mitigate the detected threats and prevent future attacks.</p>	"<p>What is Microsoft Defender for Storage?:  <a href=""https://learn.microsoft.com/en-us/azure/defender-for-cloud/defender-for-storage-introduction"">https://learn.microsoft.com/en-us/azure/defender-for-cloud/defender-for-storage-introduction</a></p> "
target is Azure Data Lake Storage	Azure Data Lake Storage	Failure to enforce secure configuration in Azure Data Lake Storage may allow an attacker to compromise infrastructure.	Tampering	"<p>Define and implement standard security configurations for network resources associated with your Azure Storage Account with Azure Policy. Use Azure Policy aliases in the Microsoft.Storage and Microsoft.Network namespaces to create custom policies to audit or enforce the network configuration of your Storage account resources.</p>
<p>You may also make use of built-in policy definitions related to Storage account, such as: Storage Accounts should use a virtual network service endpoint.</p>
<p>Use Azure Monitor to alert on deviations from configuration policy.</p>"	"<p>Azure Policy: <a href=""https://docs.microsoft.com/azure/governance/policy/tutorials/create-and-manage"">https://docs.microsoft.com/azure/governance/policy/tutorials/create-and-manage</a></p>
<p>Azure Policy built-in definitions for Azure Storage: <a href=""https://docs.microsoft.com/azure/storage/common/policy-reference#microsoftstorage"">https://docs.microsoft.com/azure/storage/common/policy-reference#microsoftstorage</a></p> "
target is Azure Data Lake Storage	Azure Data Lake Storage	Failure to segregate traffic to Azure Data Lake Storage may allow attackers to compromise infrastructure.	Tampering	"<p>Storage accounts have a public endpoint that is accessible through the internet.  You can also create private endpoints for your storage account.  Creating private endpoints assigns a private IP address from your virtual network to the storage account.  It helps secure traffic between your virtual network and the storage account over a private link.  To secure your storage account, you should first configure a rule to deny access to traffic from all networks (including internet traffic) on the public endpoint, by default.</p>"	"<p>Configure Azure Storage firewalls and virtual networks:  <a href=""https://learn.microsoft.com/en-gb/azure/storage/common/storage-network-security"">https://learn.microsoft.com/en-gb/azure/storage/common/storage-network-security</a></p>
<p>How to approach network security for your storage account: <a href=""https://learn.microsoft.com/en-us/azure/storage/common/storage-network-security/#how-to-approach-network-security-for-your-storage-account"">https://learn.microsoft.com/en-us/azure/storage/common/storage-network-security/#how-to-approach-network-security-for-your-storage-account</a></p>
<p>Use private endpoints for Azure Storage:  <a href=""https://docs.microsoft.com/azure/storage/common/storage-private-endpoints"">https://docs.microsoft.com/azure/storage/common/storage-private-endpoints</a></p> "
target is Azure Data Lake Storage	Azure Data Lake Storage	An adversary can tamper the data uploaded to Azure Data Lake Storage when HTTPS cannot be enabled.	Tampering	<p>HTTPS should be enforced when at all possible.  If this is not possible and the data classification does not require encryption you should ensure the integrity of data in transit by validating the hash (which should be generated using a cryptographically strong hashing algorithm) after downloading the blob.</p>	
target is Azure Data Lake Storage	Azure Data Lake Storage	Failure to enforce secure protocols for data encryption-in-transit to Azure Data Lake Storage may lead to data disclosure	Tampering	"<p>While Azure Storage uses TLS 1.2 on public HTTPS endpoints, TLS 1.0 and TLS 1.1 are still supported for backward compatibility.</p>
<p>To ensure clients do not connect with protocols that do not comply with the Cryptography Security Policy a minimum TLS version should be enforced.</p>"	"<p>Enforce a minimum required version of Transport Layer Security (TLS) for requests to a storage account: <a href=""https://docs.microsoft.com/azure/storage/common/transport-layer-security-configure-minimum-version?tabs=portal"">https://docs.microsoft.com/azure/storage/common/transport-layer-security-configure-minimum-version?tabs=portal</a></p> "
target is Azure Key Vault	Azure Key Vault	An unauthorised user may gain access to Azure Key Vault due to failure to implement suitable network controls	Tampering	"<p>Ensure that your Microsoft Azure Key Vaults are configured to deny access to traffic from all networks (including the public Internet). By restricting the public access to your Azure Key Vaults, you add an important layer of security, since the default action is to accept connections from clients on any network. To limit access to trusted networks and/or IP addresses, you must change the Key Vault firewall default action from ""Allow"" to ""Deny"" and configure the appropriate access.</p>

<p>Azure Private Link should be used to segregate and secure connections to Azure services over a private endpoint.</p>

<p>The access to your Azure Key Vaults should be granted to specific Azure Virtual Networks, which allow a secure network boundary for specific applications, or to public IP addresses/IP address ranges, which can enable connections from trusted Internet services and on-premises networks. Once the firewall rules are properly configured, only applications from allowed networks or IPs can access your Key Vault resources (encryption keys, secrets, certificates, etc).</p>

<p>Ensure that ""Allow trusted Microsoft services to bypass this firewall"" exception is enabled within your Azure Key Vault network firewall configuration settings in order to grant vault access to trusted Azure cloud services. The trusted Microsoft services must also be given explicit permissions within the access policies associated with the Key Vault.</p>

<p>Enabling network firewall rules for your Key Vaults will block access to incoming requests for data, including from other Azure services. To allow certain Azure cloud services to work as intended and be able to access your vault resources, you have to add an exception so that the trusted cloud services can bypass the firewall rules. If the ""Allow trusted Microsoft services to bypass this firewall"" exception is enabled, cloud services such as Azure Resource Manager, Azure Virtual Machines and Azure Disk Encryption can be granted access to your Key Vault resources. To enhance access security, all these Azure cloud services are using strong authentication methods to access your vault resources.</p>

<p>Note: Making changes to network firewall rules can impact your applications&#39; ability to connect to the Azure Key Vault. Make sure to grant access to any trusted service or network using network rules or IP addresses/ranges before you change the firewall default rule to deny access.</p>

"	"<p>Azure Key Vault network security: <a href=""https://docs.microsoft.com/azure/key-vault/general/how-to-azure-key-vault-network-security"">https://docs.microsoft.com/azure/key-vault/general/how-to-azure-key-vault-network-security</a></p>
<p>Integrate Key Vault with Azure Private Link: <a href=""https://learn.microsoft.com/en-gb/azure/key-vault/general/private-link-service"">https://learn.microsoft.com/en-gb/azure/key-vault/general/private-link-service</a></p>
<p>Configure Azure Key Vault firewalls and virtual networks: <a href=""https://docs.microsoft.com/en-us/azure/key-vault/general/network-security"">https://docs.microsoft.com/en-us/azure/key-vault/general/network-security</a></p>
<p>Virtual network service endpoints for Azure Key Vault: <a href=""https://docs.microsoft.com/en-us/azure/key-vault/general/overview-vnet-service-endpoints"">https://docs.microsoft.com/en-us/azure/key-vault/general/overview-vnet-service-endpoints</a></p>

<p>Azure CLI Documentation:</p>
<p>az keyvault list: <a href=""https://docs.microsoft.com/en-us/cli/azure/keyvault?view=azure-cli-latest#az-keyvault-list"">https://docs.microsoft.com/en-us/cli/azure/keyvault?view=azure-cli-latest#az-keyvault-list</a></p>
<p>az keyvault show: <a href=""https://docs.microsoft.com/en-us/cli/azure/keyvault?view=azure-cli-latest#az-keyvault-show"">https://docs.microsoft.com/en-us/cli/azure/keyvault?view=azure-cli-latest#az-keyvault-show</a></p>
<p>az keyvault update: <a href=""https://docs.microsoft.com/en-us/cli/azure/keyvault?view=azure-cli-latest#az-keyvault-show"">https://docs.microsoft.com/en-us/cli/azure/keyvault?view=azure-cli-latest#az-keyvault-show</a></p>
<p>az keyvault network-rule add: <a href=""https://docs.microsoft.com/en-us/cli/azure/keyvault?view=azure-cli-latest#az-keyvault-show"">https://docs.microsoft.com/en-us/cli/azure/keyvault?view=azure-cli-latest#az-keyvault-show</a></p> "
target is Azure Key Vault	Azure Key Vault	An adversary may exploit a weakly configured Azure Key Vault to gain unauthorised access.	Tampering	"<p>Use Microsoft Defender for Cloud to configure Azure Policy to audit and enforce configurations of your Azure Key Vault.</p>

<p>Use Azure Monitor to create alerts when there is a configuration deviation detected on the resources.</p>"	"<p>Microsoft Defender for Azure Key Vault: <a href=""https://docs.microsoft.com/azure/defender-for-cloud/defender-for-key-vault-introduction"">https://docs.microsoft.com/azure/defender-for-cloud/defender-for-key-vault-introduction</a></p>

<p>Azure Key Vault policy:  <a href=""https://docs.microsoft.com/azure/key-vault/policy-reference"">https://docs.microsoft.com/azure/key-vault/policy-reference</a></p>
"
target is Azure Key Vault and ( target.Credential Type is 'Certificates' or  target.Credential Type is 'Secrets and Certificates' )	Azure Key Vault	A malicious actor may be able to create an unauthorised certificate under the organisation's domain	Tampering	"<p>Ensure that Certificate Transparency feature is enabled for all Azure Key Vault SSL/TLS certificates in order to adhere to web security best practices. Certificate Transparency (CT) is a new Internet standard that addresses the concerns about mis-issued certificates by making the Transport Layer Security (TLS) ecosystem publicly auditable. Without CT, as domain owner there is no way to be aware of certificates that are issued to your domain, unless you request it yourself. With Certificate Transparency, you can easily audit the quality of the certificates that the Certificate Authority (CA) issued and determine whether the certificate is compliant with the standards enforced by the Certification Authority Browser Forum, also known as CA/Browser Forum.</p>

<p>Certificate Transparency aims to remediate SSL/TLS certificate-based threats by making the issuance process and the existence of the certificates open to scrutiny by domain owners, CAs, and domain users. Specifically, Certificate Transparency (CT) has three main goals:</p>

<p>* Make it extremely difficult for a Certificate Authority (CA) to issue an SSL certificate for a domain without the certificate being visible to the owner of that domain.<br/>

* Provide an open auditing and a monitoring system that allows any domain owner or CA to determine whether the SSL certificate has been mistakenly or maliciously issued.<br/>

* Protect users from being duped by SSL certificates that were mistakenly or maliciously issued.</p>"	"<p>About keys, secrets, and certificates: <a href=""https://docs.microsoft.com/en-us/azure/key-vault/general/about-keys-secrets-certificates"">https://docs.microsoft.com/en-us/azure/key-vault/general/about-keys-secrets-certificates</a></p>
<p>Introduction of AD CS Certificate Transparency: <a href=""https://mskb.pkisolutions.com/kb/4093260"">https://mskb.pkisolutions.com/kb/4093260</a></p>
<p>What is Certificate Transparency?: <a href=""http://www.certificate-transparency.org/what-is-ct"">http://www.certificate-transparency.org/what-is-ct</a></p>

<p>Azure CLI Documentation:</p>
<p>az keyvault list: <a href=""https://docs.microsoft.com/en-us/cli/azure/keyvault?view=azure-cli-latest#az-keyvault-list"">https://docs.microsoft.com/en-us/cli/azure/keyvault?view=azure-cli-latest#az-keyvault-list</a></p>
<p>az keyvault certificate list: <a href=""https://docs.microsoft.com/en-us/cli/azure/keyvault/certificate?view=azure-cli-latest#az-keyvault-certificate-list"">https://docs.microsoft.com/en-us/cli/azure/keyvault/certificate?view=azure-cli-latest#az-keyvault-certificate-list</a></p>
<p>az keyvault certificate show: <a href=""https://docs.microsoft.com/en-us/cli/azure/keyvault/certificate?view=azure-cli-latest#az-keyvault-certificate-list"">https://docs.microsoft.com/en-us/cli/azure/keyvault/certificate?view=azure-cli-latest#az-keyvault-certificate-list</a></p>
<p>az keyvault certificate set-attributes: <a href=""https://docs.microsoft.com/en-us/cli/azure/keyvault/certificate?view=azure-cli-latest#az-keyvault-certificate-list"">https://docs.microsoft.com/en-us/cli/azure/keyvault/certificate?view=azure-cli-latest#az-keyvault-certificate-list</a></p> "
target is Azure Storage Account	Azure Storage Account	An adversary may exploit weakly configured Azure Storage to gain access.	Tampering	<p>Use Microsoft Defender for Storage to provide an additional layer of security intelligence that detects unusual and potentially harmful attempts to access or exploit storage accounts.  It uses advanced threat detection capabilities and Microsoft Threat Intelligence data to provide contextual security alerts. Those alerts also include steps to mitigate the detected threats and prevent future attacks.</p>	"<p>Introduction to Microsoft Defender for Storage:  <a href=""https://docs.microsoft.com/azure/defender-for-cloud/defender-for-storage-introduction"">https://docs.microsoft.com/azure/defender-for-cloud/defender-for-storage-introduction</a></p> "
